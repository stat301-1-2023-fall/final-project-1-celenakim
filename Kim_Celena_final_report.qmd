---
title: "What Makes a Hollywood Movie a Hit or a Flop?"
subtitle: |
  | Final Project 
  | Data Science 1 with R (STAT 301-1)
author: "Celena Kim"
date: today

format:
  html:
    toc: true
    embed-resources: true
    
execute:
  echo: false
  warning: false

from: markdown+emoji 
---

```{r}
#| label: basic-setup

# load packages and data
library(tidyverse)
library(scales)
library(ggrepel)
library(patchwork)

movie_data <- read_csv("data/movie_data.csv")
```


::: {.callout-tip icon="false"}
## Github Repo Link

<https://github.com/stat301-1-2023-fall/final-project-1-celenakim>
:::

## Introduction
As an avid movie lover, I have always been curious about what factors play into making some Hollywood movies critically acclaimed blockbusters while others fade into the background. Beyond solely the opening weekend numbers, I am interested in exploring the interplay between more extensive variables that contribute to a film’s propensity to ultimately be a hit or a flop. Specifically, I think it would be very interesting to focus on the five factors of critic and audience ratings, opening weekend revenue, gross (domestic, foreign, and worldwide), budget and budget recovery, and Oscar wins. I also am curious to see whether time of year/seasons have an impact on a movie's success, and if there is a particular season in which the most successful movies are released. By focusing on these main variables for my analysis, I hope to explore my research question by discovering patterns and compelling correlations between the variables on a range of univariate to multivariate levels. I am interested in exploring whether certain variables affect another and how certain variables work together to contribute to a movie’s overall success rate. In order to carry out this analysis, I will be utilizing a data set found on the Kaggle website called “Hollywood Hits and Flops (2007 - 2023)”, described in the next section.

## Data Overview and Quality
text

# Explorations: What variables contribute to a movie's overall success rate?
## Variable 1: Ratings
Within this dataset, the 3 main movie rating measures are the Rotten Tomatoes score (audience and critic), Metacritic score (audience and critic), and IMDb rating. 
```{r}
#| label: fig-yearly-avg-ratings
#| fig-cap: caption...

movie_data |> 
  group_by(year) |> 
  summarize(avg_critics_ratings = mean(average_critics, 
                                       na.rm = TRUE),
            avg_audience_ratings = mean(average_audience, 
                                        na.rm = TRUE)) |> 
  ggplot(aes(x = year)) +
  geom_line(aes(y = avg_critics_ratings, 
                color = "Critics"), 
            size = 1.5) +
  geom_line(aes(y = avg_audience_ratings, 
                color = "Audience"), 
            linetype = "dashed", 
            size = 1.5) +
  labs(title = "Average Audience and Critic Ratings Over the Years",
       subtitle = "Both the average audience and average critic ratings have increased 
over the years overall. Critics seem to rate lower than audiences.",
       x = "Year",
       y = "Average Rating",
       color = "Rating Group") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  ylim(0, 100)
```
@fig-yearly-avg-ratings visualizes how the average of Rotten Tomatoes and Metacritic scores have changed over the years, separated by audience and critic rating groups. Overall, it appears that these ratings as a whole have increased since 2007. Additionally, the audience rating group seems to consistenly give higher ratings than the critic rating group. This analysis of ratings over the years serves to help us understand how much the numbers for the two rating groups of audience and critics differ, as well as visualizing the overall pattern of critic ratings over the years.

## Variable 2: Opening weekend revenue
A movie's opening weekend revenue refers to the total box office earnings that the film earned during its first weekend of release in theaters. 
```{r}
#| label: fig-yearly-opening-wknd
#| fig-cap: caption...

year_opening_success <- movie_data |> 
  group_by(year) |> 
  summarize(mean_opening_success = round(mean(opening_weekend_million, na.rm = TRUE)))  |> 
  arrange(desc(mean_opening_success)) 

ggplot(year_opening_success, aes(x = year, y = mean_opening_success)) +
  geom_line() +
  geom_point() +
  labs(x = "Year", 
       y = "Mean Opening Weekend Earnings (in millions of $)", 
       title = "Average Opening Weekend Earnings for Hollywood Movies from 2007-2022") +
  ylim(0, 28) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot")
```
@fig-yearly-opening-wknd visualizes the change in the mean opening weekend earnings (in millions) for Hollywood movies from 2007-2022. As can be seen by the graph, the years with the most successful opening weekends in terms of highest mean earnings are the years 2012 and 2014, closely tied with an average earning of 27 million dollars. The lowest point on the graph corresponds to 2020, with that year earning the least during opening weekend: 8 million dollars. This data definitely reflects the times/economy of the country during this year, as 2020 was the year that America was under quarantine and movie theaters were shut down, so they earned significantly less money than as compared to previous years. This is certainly something to keep in mind throughout this variable analysis, as the opening weekend revenue for 2020 is greatly impacted by the pandemic.

```{r}
#| label: fig-opening-wknd-by-budget
#| fig-cap: The correlation between a movie's production budget in millions of dollars and how much it earned during its opening weekend.

movie_data |> 
  ggplot(aes(x = budget_million, y = opening_weekend_million)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x = "Movie Budget (millions of $)",
       y = "Opening Weekend Earnings (millions of $)",
       title = "Opening weekend earnings increase as movie budget increases") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot")

```
In @fig-opening-wknd-by-budget, there is a clear positive association between a Hollywood movie's budget and its opening weeked earnings. This suggests that, on average, movies with higher production budgets tend to achieve greater financial success during their initial release weekends. 

## Variable 3: Domestic, foreign, & worldwide gross

## Variable 4: Budget recovery

## Variable 5: Oscar wins

## Seasons Impact
These analyses seek to explore how the five main variables above vary/are impacted by the seasons.

#### Ratings:
```{r}
#| label: fig-seasonal_ratings
#| fig-cap: caption...

seasonal_critics_plot <- movie_data |> 
  group_by(season)  |> 
  summarise(avg_critic_rating = round(mean(average_critics, na.rm = TRUE)))  |> 
  arrange(desc(avg_critic_rating))  |> 
  ggplot(aes(x = season, y = avg_critic_rating, fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Critic Ratings by Season",
       x = "Season",
       y = "Average Critic Rating",
       fill = "Season") +
  theme_minimal() +
  ylim(0, 70)

seasonal_audience_plot <-  movie_data |>  
  group_by(season) |> 
  summarise(avg_audience_rating = mean(average_audience, na.rm = TRUE)) |> 
  arrange(desc(avg_audience_rating)) |> 
  ggplot(aes(x = season, y = avg_audience_rating, fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Audience Ratings by Season",
       x = "Season",
       y = "Average Audience Rating",
       fill = "Season") +
  theme_minimal() +
  ylim(0, 70)


seasonal_critics_plot + seasonal_audience_plot
```


## Conclusion
text

## References
text

## Appendix: technical info
text

## Appendix: extra explorations
![](figures/extra_explos_figures/primary_genre_script_type_plot.png)


