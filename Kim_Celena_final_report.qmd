---
title: "What Makes a Hollywood Movie a Hit or a Flop?"
subtitle: |
  | Final Project 
  | Data Science 1 with R (STAT 301-1)
author: "Celena Kim"
date: today

format:
  html:
    toc: true
    embed-resources: true
    
execute:
  echo: false
  warning: false

from: markdown+emoji 
---

```{r}
#| label: basic-setup

# load packages and data
library(tidyverse)
library(scales)
library(ggrepel)
library(patchwork)

movie_data <- read_csv("data/movie_data.csv")
```


::: {.callout-tip icon="false"}
## Github Repo Link

<https://github.com/stat301-1-2023-fall/final-project-1-celenakim>
:::

## Introduction
As an avid movie lover, I have always been curious about what factors play into making some Hollywood movies critically acclaimed blockbusters while others fade into the background. Beyond solely the opening weekend numbers, I am interested in exploring the interplay between more extensive variables that contribute to a film’s propensity to ultimately be a hit or a flop. Specifically, I think it would be very interesting to focus on the five factors of critic and audience ratings, opening weekend revenue, gross (domestic, foreign, and worldwide), budget and budget recovery, and Oscar wins. I also am curious to see whether time of year/seasons have an impact on a movie's success, and if there is a particular season in which the most successful movies are released. By focusing on these main variables for my analysis, I hope to explore my research question by discovering patterns and compelling correlations between the variables on a range of univariate to multivariate levels. I am interested in exploring whether certain variables affect another and how certain variables work together to contribute to a movie’s overall success rate. In order to carry out this analysis, I will be utilizing a data set found on the Kaggle website called “Hollywood Hits and Flops (2007 - 2023)”, described in the next section.

## Data Overview and Quality
text

# Explorations: What variables contribute to a movie's overall success rate?
## Variable 1: Ratings
Within this dataset, the 3 main movie rating measures are the Rotten Tomatoes score (audience and critic), Metacritic score (audience and critic), and IMDb rating. 
```{r}
#| label: fig-yearly-avg-ratings
#| fig-cap: A visualization of the change in audience and critic ratings of Hollywood movies from 2007-2022.

movie_data |> 
  group_by(year) |> 
  summarize(avg_critics_ratings = mean(average_critics, 
                                       na.rm = TRUE),
            avg_audience_ratings = mean(average_audience, 
                                        na.rm = TRUE)) |> 
  ggplot(aes(x = year)) +
  geom_line(aes(y = avg_critics_ratings, 
                color = "Critics"), 
            size = 1.5) +
  geom_line(aes(y = avg_audience_ratings, 
                color = "Audience"), 
            linetype = "dashed", 
            size = 1.5) +
  labs(title = "Change in Average Audience and Critic Ratings from 2007-2022",
       subtitle = "Both the average audience and average critic ratings have increased 
over the years overall. Critics seem to rate lower than audiences.",
       x = "Year",
       y = "Average Rating",
       color = "Rating Group") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  ylim(0, 100)
```
@fig-yearly-avg-ratings visualizes how the average of Rotten Tomatoes and Metacritic scores have changed over the years, separated by audience and critic rating groups. Overall, it appears that these ratings as a whole have increased since 2007. Additionally, the audience rating group seems to consistenly give higher ratings than the critic rating group. This analysis of ratings over the years serves to help us understand how much the numbers for the two rating groups of audience and critics differ, as well as visualizing the overall pattern of critic ratings over the years.

## Variable 2: Opening weekend revenue
A movie's opening weekend revenue refers to the total box office earnings that the film earned during its first weekend of release in theaters. 
```{r}
#| label: fig-yearly-opening-wknd
#| fig-cap: A visualization of the change in yearly average opening weekend revenue for Hollywood movies from 2007-2022.

year_opening_success <- movie_data |> 
  group_by(year) |> 
  summarize(mean_opening_success = round(mean(opening_weekend_million, na.rm = TRUE)))  |> 
  arrange(desc(mean_opening_success)) 

potential_outliers <- year_opening_success |>
  filter(mean_opening_success < 10)

ggplot(year_opening_success, aes(x = year, y = mean_opening_success)) +
  geom_line() +
  geom_point() +
  geom_text_repel(data = potential_outliers, 
                  aes(label = "")) +
  geom_label(data = data.frame(label = "COVID-19 Pandemic"),
             aes(x = 2018.5, 
                 y = 7, 
                 label = label),
             fill = "gray", 
             alpha = 0.2, 
             hjust = 0, 
             vjust = 0) +
  geom_point(data = potential_outliers, 
             color = "red") +
  geom_point(
    data = potential_outliers,
    color = "red", 
    size = 3, 
    shape = "circle open") +
  labs(x = "Year", 
       y = "Mean Opening Weekend Earnings (in millions of $)", 
       title = "Average Opening Weekend Earnings for Hollywood Movies from 2007-2022",
       subtitle = "The average opening weekend revenue for 2020 is heavily impacted by the COVID-19 pandemic.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  ylim(3, 28)
```
@fig-yearly-opening-wknd visualizes the change in the mean opening weekend earnings (in millions) for Hollywood movies from 2007-2022. As can be seen by the graph, the years with the most successful opening weekends in terms of highest mean earnings are the years 2012 and 2014, closely tied with an average earning of 27 million dollars. The lowest point on the graph corresponds to 2020, with that year earning the least during opening weekend: 8 million dollars. This data definitely reflects the times/economy of the country during this year, as 2020 was the year that America was under quarantine and movie theaters were shut down, so they earned significantly less money than as compared to previous years. This is certainly something to keep in mind throughout this variable analysis, as the opening weekend revenue for 2020 is greatly impacted by the pandemic.

```{r}
#| label: fig-opening-wknd-by-budget
#| fig-cap: The correlation between a Hollywood movie's production budget in millions of dollars and how much it earned during its opening weekend.

movie_data |> 
  ggplot(aes(x = budget_million, y = opening_weekend_million)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x = "Movie Budget (millions of $)",
       y = "Opening Weekend Earnings (millions of $)",
       title = "Opening weekend earnings increase as movie budget increases",
       subtitle = "There is a direct positive association between the two variables.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot")

```
In @fig-opening-wknd-by-budget, there is a clear positive association between a Hollywood movie's budget and its opening weeked earnings. This suggests that, on average, movies with higher production budgets tend to achieve greater financial success during their initial release weekends. From this, it can be concluded that the variables of movie budget and opening weekend revenue are related to one another, in that the budget of a movie impacts it's opening weekend revenue earnings.

```{r}
#| label: fig-opening-wknd-by-genre-script-type
#| fig-cap: The top 5 genres and script types of movies that earned the most revenue during their opening weekends.
genre_opening_wknd_plot <- movie_data |> 
  group_by(genre) |> 
  summarize(mean_opening_success = mean(opening_weekend_million)) |> 
  arrange(desc(mean_opening_success)) |> 
  slice_head(n = 5) |> 
  ggplot(aes(x = fct_infreq(genre, 
                             mean_opening_success), 
             y = mean_opening_success,
             fill = genre)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 5 Genres with Highest Opening 
Weekend Earnings",
       subtitle = "The sci-fi, fantasy genre has the highest 
average opening weekend revenue.",
       x = "Genre",
       y = "Mean Opening Weekend Earnings (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        axis.title.y = element_text(size = 6),
        legend.position = "none") 

scripttype_opening_wknd_plot <- movie_data |> 
  group_by(script_type) |> 
  summarize(mean_opening_success = mean(opening_weekend_million)) |> 
  arrange(desc(mean_opening_success)) |> 
  slice_head(n = 5) |> 
  ggplot(aes(x = fct_infreq(script_type, 
                             mean_opening_success), 
             y = mean_opening_success,
             fill = script_type)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 5 Script Types with 
Highest Opening Weekend Earnings",
       subtitle = "The sequel, adaptation script type has the 
highest average opening weekend revenue.",
       x = "Script Type",
       y = "Mean Opening Weekend Earnings (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        axis.title.y = element_text(size = 6),
        legend.position = "none")  +
  scale_fill_viridis_d() 

genre_opening_wknd_plot + scripttype_opening_wknd_plot
```
@fig-opening-wknd-by-genre-script-type displays that the genre combination that earned the greatest average revenue during its opening weekend of release is sci-fi & fantasy, and the script type combination that earned the greatest average revenue during its opening weekend of release is sequel & adaptation. This suggests that the movies categorized as a sci-fi fantasy genre hybrid earned more most during the first weekend of their release than other genre combinations, and movies categorized as a sequel adaptation script type hybrid also earned that title.

```{r}
#| label: fig-opening-wknd-oscar
#| fig-cap: The mean opening weekend revenue for movies that have one at least won Oscar award is less than the mean for movies who have won 0 Oscars.
movie_data |> 
  filter(!is.na(oscar_winners)) |> 
  ggplot(aes(x = opening_weekend_million, y = oscar_winners)) +
  geom_boxplot() +
  labs(title = "Opening Weekend Revenue by Oscar Wins",
       subtitle = "Oscar winning movies have a lower average of opening weekend revenue earnings.",
       x = "Opening Weekend Revenue (in millions of $)",
       y = "Oscar Winner") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot")
```
@fig-opening-wknd-oscar shows that Hollywood movies that have won at least one Oscar award or greater have an average opening weekend revenue that is actually less than movies that have not won any Oscars. This could suggest that the mean opening weekend success of a movie does not correlate with winning an Oscar, and these two variables are unrelated to one another. In other words, having a high opening weekend revenue may not increase a movie's chance of winning an Oscar.

```{r}
#| label: fig-opening-wknd-dom-for
#| fig-cap: There is a strong, positive correlation for both associations, but it is slightly stronger for domestic gross by opening weekend revenue.

opening_wknd_domgross <- movie_data |> 
  ggplot(aes(x = opening_weekend_million, 
             y = domestic_gross_million)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Domestic Gross by Opening Weekend Revenue",
       subtitle = "There is a strong positive association between the two 
variables.",
       x = "Opening Weekend Revenue (in millions of $)",
       y = "Domestic Gross (in millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", 
                                  size = 10.5),
        plot.subtitle = element_text(size = 9),
        plot.title.position = "plot")

opening_wknd_forgross <- movie_data |> 
  ggplot(aes(x = opening_weekend_million, 
             y = foreign_gross_million)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = " Foreign Gross by Opening Weekend Revenue",
       subtitle = " There is a strong positive association between the two 
 variables.",
       x = "Opening Weekend Revenue (in millions of $)",
       y = "Foreign Gross (in millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 10.5),
        plot.subtitle = element_text(size = 9),
        plot.title.position = "plot")

opening_wknd_domgross + opening_wknd_forgross
```
@fig-opening-wknd-dom-for displays very strong, positive correlations for both associations of domestic gross by opening weekend revenue and foreign gross by opening weekend revenue. This suggests that a Hollywood movie's performance during its opening weekend of release has a direct positive association with its overall domestic and foreign grosses. That is, as opening weekend earnings success increases, so will domestic and foreign gross successes. Additionally, the correlation between opening weekend revenue and domestic gross seems to be slightly steeper than the correlation between opening weekend revenue and foreign gross, suggesting that opening weekend revenue performance has a slightly greater impact on its domestic gross performance than it does its foreign gross performance.

## Variable 3: Domestic, foreign, & worldwide gross

## Variable 4: Budget & budget recovery

## Variable 5: Oscar wins

## Variable 6: Seasonal Release Date
These analyses seek to explore how the five main variables above vary/are impacted by the season a movie is released in, and what seasonal release date trends may exist in influencing a movie's success rate.

#### Ratings:
```{r}
#| label: fig-seasonal_ratings
#| fig-cap: A comparison of the mean ratings of movies based on the season they were released in, between the critic and audience rating groups.

seasonal_critics_plot <- movie_data |> 
  group_by(season)  |> 
  summarise(avg_critic_rating = round(mean(average_critics, 
                                           na.rm = TRUE)))  |> 
  arrange(desc(avg_critic_rating))  |> 
  ggplot(aes(x = season, 
             y = avg_critic_rating, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Critic Ratings by Season 
Movie was Released In",
       subtitle = "Movies released in the Fall have the greatest
average critic rating.",
       x = "Season",
       y = "Average Critic Rating",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none") +
  ylim(0, 70) 

seasonal_audience_plot <-  movie_data |>  
  group_by(season) |> 
  summarise(avg_audience_rating = mean(average_audience, 
                                       na.rm = TRUE)) |> 
  arrange(desc(avg_audience_rating)) |> 
  ggplot(aes(x = season, 
             y = avg_audience_rating, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Audience Ratings by Season 
Movie was Released In",
       subtitle = "Movies released in the Fall have the greatest
average audience rating.",
       x = "Season",
       y = "Average Audience Rating",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none") +
  ylim(0, 70) 

seasonal_critics_plot + seasonal_audience_plot
```
@fig-seasonal_ratings shows a comparison between the average ratings for each season between the critic and audience rating groups. There appears to be a similar pattern for both rating groups' seasonal average critic numbers, with the highest ratings given for movies released in the Fall, and the lowest ratings given for movies released in the Winter. This reveals a similarity in the seasonal patterns of movie ratings for the two rating groups. However, the taller bar graphs in the plot on the right depict a disparity between the two groups' rating patterns in that the audience rating group gives out higher ratings than the critic rating group, as revealed in @fig-yearly-avg-ratings. @fig-seasonal_ratings stands to visualize a way in which the rating patterns for these two groups are similar, and confirm a previous finding of a way that their patterns differ. An overall conclusion can be made that movies released in the Fall have the highest ratings, while movies released in the Winter have the lowest ratings.

#### Opening weekend revenue:
```{r}
#| label: fig-seasonal_opening_wknd
#| fig-cap: A comparison of the average opening weekend revenues in millions of dollars for movies based on what season they were relased in.

movie_data |> 
  group_by(season) |> 
  summarise(avg_opening_rev = mean(opening_weekend_million, 
                                   na.rm = TRUE)) |> 
  arrange(desc(avg_opening_rev)) |> 
  ggplot(aes(x = season, 
             y = avg_opening_rev, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Opening Weekend Revenue by Season Movie was Released In",
       subtitle = "Movies released in the Spring have the greatest average opening weekend revenue.",
       x = "Season",
       y = "Average Opening Weekend Revenue (millions of $)",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  theme(legend.position = "none")
```
In @fig-seasonal_opening_wknd, it is clear that movies with the highest average opening weekend revenue were released in the Spring. This could suggest that movies that are released in the Spring are more successful in terms of generating more earnings during their first weekend in theaters than movies released in other seasons.

#### Domestic, foreign, and worldwide gross:
```{r}
#| label: fig-seasonal_gross
#| fig-cap: The average total revenue generated by films from all sources globally by the season the film was released in.

movie_data |> 
  group_by(season) |> 
  summarise(avg_worldwide_gross = mean(worldwide_gross_million, na.rm = TRUE)) |> 
  arrange(desc(avg_worldwide_gross)) |> 
  ggplot(aes(x = season, 
             y = avg_worldwide_gross, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Worldwide Gross Earnings by Season Movie was Released In",
       subtitle = "Movies released in the summer have the greatest average worldwide gross.",
       x = "Season",
       y = "Worldwide Gross (millions of $)",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  theme(legend.position = "none")
```
@fig-seasonal_gross shows that movies released during the Summer months have the highest average worldwide gross. This could be due to the fact that in many countries around the world, kids are on summer vacation during these months, and thus families are more likely to go to the movies and contribute to increased ticket sales.

#### Budget:
```{r}
#| label: fig-seasonal_budget
#| fig-cap: A comparison of the average production budget of movies based on what season they were released in.

movie_data |> 
  group_by(season) |> 
  summarise(avg_budgets = mean(budget_million, na.rm = TRUE)) |> 
  arrange(desc(avg_budgets)) |> 
  ggplot(aes(x = season, 
             y = avg_budgets, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Movie Budgets by Season Movie was Released In",
       subtitle = "Movies released in the Spring have the highest average movie budgets.",
       x = "Season",
       y = "Average Movie Budget (millions of $)",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  theme(legend.position = "none")
```
@fig-seasonal_budget shows that movies released in the Spring have the highest average movie budgets. This directly aligns with previous findings in the EDA. In @fig-opening-wknd-by-budget, it was concluded that there exists a positive association between a Hollywood movie's budget and its opening weeked earnings. Therefore, since @fig-seasonal_opening_wknd revealed that the season of movies released with the highest average opening weekend revenue was Spring, then the season of movies released with the highest average movie budgets should also be the Spring, and that is what we see in this plot. This supports our finding of the positive correlation that exists between a movie's budget and opening weekend revenue.


#### Oscar wins:
```{r}
#| label: fig-seasonal_oscars
#| fig-cap: The distribution of Oscar wins based on what season the movie was released in.

movie_data |> 
  group_by(season) |> 
  filter(!is.na(oscar_winners)) |> 
  summarise(oscar_count = sum(oscar_winners)) |> 
  arrange(desc(oscar_count)) |> 
  ggplot(aes(x = season, 
             y = oscar_count, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Number of Oscar Wins by Season Movie was Released In",
       subtitle = "Movies released in the Fall have the highest number of Oscar wins.",
       x = "Season",
       y = "Number of Oscar wins",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  theme(legend.position = "none")
```
In @fig-seasonal_oscars, movies that were released in the Fall season won significantly more Oscars than movies released in other seasons. This is due to the fact that the Fall season is close to around the time when Oscar voting starts, and thus these films are more salient/relavent among the voters, but there is still enough time away from the start of voting for the films to gain enough popularity and traction before the awards are given out. From this, we can conclude that when defining a film's success solely defined by the number of Oscar wins, releasing the film during the Fall season will greatly increase its chances of being successful. 

## Conclusion
text

## References
text

## Appendix: technical info
text

## Appendix: extra explorations
![](figures/extra_explos_figures/primary_genre_script_type_plot.png)

```{r}
#| label: fig-genre-trends
#| fig-cap: Trends in genre prevalence for Hollywood movies from 2007-2022.

movie_data |> 
  group_by(year, primary_genre) |> 
  filter(!is.na(primary_genre)) |> 
  summarize(count = n()) |> 
  ggplot(aes(x = year, y = count, color = primary_genre)) +
  geom_line() +
  labs(title = "Popularity of Genres Over Years",
       x = "Year",
       y = "Number of Movies",
       color = "Primary Genre")  +
  theme_minimal() +
  ylim(0, 30)
```

