---
title: "What Makes a Hollywood Movie a Hit or a Flop?"
subtitle: |
  | Final Project 
  | Data Science 1 with R (STAT 301-1)
author: "Celena Kim"
date: today

format:
  html:
    toc: true
    embed-resources: true
    
execute:
  echo: false
  warning: false

from: markdown+emoji 
---

```{r}
#| label: basic-setup

# load packages and data
library(tidyverse)
library(scales)
library(ggrepel)
library(patchwork)

movie_data <- read_csv("data/movie_data.csv")
```

::: {.callout-tip icon="false"}
## Github Repo Link

<https://github.com/stat301-1-2023-fall/final-project-1-celenakim>
:::

## Introduction

As an avid movie lover, I have always been curious about what factors play into making some Hollywood movies critically acclaimed blockbusters while others fade into the background. Beyond solely the ticket sales, I am interested in exploring the interplay between more extensive variables that contribute to a film's propensity to ultimately be a hit or a flop. Specifically, I think it would be very interesting to explore this by defining a movie's success based on the factors of critic and audience ratings, opening weekend revenue, gross (domestic, foreign, and worldwide), budget and budget recovery, and Oscar wins. I also am curious to see whether the time of year/season has an impact on a movie's success, and if there is a particular season in which the most successful movies are released. By focusing on these main variables for my analysis, I hope to explore my research question by discovering patterns and compelling correlations between the variables on a range of univariate to multivariate levels. I am interested in exploring whether certain variables affect one another and how certain variables work together to contribute to a movie's overall success rate. In order to carry out this analysis, I will be utilizing a data set found on the Kaggle website called "Hollywood Hits and Flops (2007 - 2023)", described in the next section.

## Data Overview and Quality

The data source that I chose for my project is called [Hollywood Hits and Flops (2007 - 2023)](https://www.kaggle.com/datasets/sujaykapadnis/hollywood-hits-and-flops-2007-2023/) by David McCandless found on [Kaggle](https://www.kaggle.com). This data set contains information about 1,967 Hollywood movies from 2007-2022, such as each movie's Rotten Tomatoes score, opening weekend revenue, genre, Oscar wins, budget recovery percentage, etc., all of which are variables that contribute to a movie's overall success rate. In its raw form, there are 16 separate CSV files, each corresponding to movie data for each year from 2007-2022. In order to conduct an EDA with all the files at once, I decided to join the 16 files together. However, while the content of the 16 files is mostly similar with relatively the same variables/columns, there are some notable differences between the files, making the joins not a 1:1 perfect fit. Moreover, there were many variable conversions and variable additions that needed to be made in order to carry out my planned explorations. With these conditions, an extensive data joining and clean-up process was required to ultimately end up with my final data set called "movie_data". A more detailed account of this process can be found in the section of this report titled "Appendix: technical info". "movie_data" is a 354.1 KB CSV file of 1,967 observations and 33 variables of character, double, integer, logical, and date types. For my analysis, I plan to explore this data set in its entirety by splitting up its variables into 6 main categories: "ratings", "opening weekend success", "gross revenue success", "budget and budget recovery", "Oscar wins", and "season of release". Additionally, I plan to use the categorical variables of "genre", "script type", and "distributor" within these analyses to explore how distributions may vary within these categories. In terms of missingness issues, there appears to be a significant amount of missing values for the variables "primary genre", "oscar award detail", "distributor company", and "IMDb rating". With these variables containing a lot of missing information, it may be difficult to make accurate conclusions about their distributions, which is something to keep in mind throughout this analysis. Overall, the "movie_data" data set contains a great number of various categories of success to explore to ultimately understand what the ideal conditions for a movie to be successful are, and how the variables that define a movie's success interact with one another.

# Explorations: What variables contribute to a movie's overall success rate? How do these variables interact with eachother, and what characteristics ultimately lead to a movie being successful among various audiences?

## Variable 1: Ratings

Within this data set, the 3 main movie rating measures are the Rotten Tomatoes score (audience and critic), Metacritic score (audience and critic), and IMDb rating.

```{r}
#| label: fig-yearly-avg-ratings
#| fig-cap: A visualization of the change in audience and critic ratings of Hollywood movies from 2007-2022.

movie_data |> 
  group_by(year) |> 
  summarize(avg_critics_ratings = mean(average_critics, 
                                       na.rm = TRUE),
            avg_audience_ratings = mean(average_audience, 
                                        na.rm = TRUE)) |> 
  ggplot(aes(x = year)) +
  geom_line(aes(y = avg_critics_ratings, 
                color = "Critics"), 
            size = 1.5) +
  geom_line(aes(y = avg_audience_ratings, 
                color = "Audience"), 
            linetype = "dashed", 
            size = 1.5) +
  labs(title = "Change in Average Audience and Critic Ratings from 2007-2022",
       subtitle = "Both the average audience and average critic ratings have increased 
over the years overall. Critics seem to rate lower than audiences.",
       x = "Year",
       y = "Average Rating",
       color = "Rating Group") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  ylim(0, 100) +
  scale_x_continuous(breaks = seq(min(movie_data$year),
                                  max(movie_data$year), 
                                  by = 2)) 
```

@fig-yearly-avg-ratings visualizes how the average of Rotten Tomatoes and Metacritic scores have changed over the years, separated by audience and critic rating groups. Overall, it appears that these ratings as a whole have slightly increased since 2007. There are many different factors that could have led to this gradual increase, perhaps that the quality of movies has improved over time, or that reviewers have become more lenient in their scores, but there is not enough information to make a concrete explanation for this increase. Additionally, the audience rating group seems to consistently give higher ratings than the critic rating group, possibly suggesting that they are less harsh when it comes to reviewing films. This analysis of ratings over the years serves to help us understand how much the behaviors of the two rating groups of audience and critics differ, as well as visualize the overall pattern of critic ratings over the years.

```{r}
#| label: fig-critic-ratings-oscar
#| fig-cap: The distribution of the average of Rotten Tomatoes critic ratings and Metacritic critic ratings for movies that have won at least one Oscar and movies who have not won any Oscars.

movie_data |> 
  filter(!is.na(oscar_winners)) |> 
  ggplot(aes(x = average_critics, y = oscar_winners)) +
  geom_boxplot() +
  labs(x = "Average Critic Rating",
       y = "Oscar Winner",
       title = "Distribution of Critic Ratings for Oscar-winning Movies and Movies with 
0 Oscars",
       subtitle = "Oscar-winning movies have a higher mean critic rating.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        legend.position = "top")
```

@fig-critic-ratings-oscar makes use of two measures of movie success that are determined solely by movie critics: Oscar wins and average critic movie ratings. As can be seen in the box plot, Hollywood movies that have won at least one Oscar award have a higher average of Rotten Tomatoes and Metacritic critic ratings than those that have not won any Oscars. This correlation suggests a similar pattern between critics' movie assessment and award recognition, in that movies that are praised enough by critics to win an Oscar are also favored highly among Rotten Tomatoes and Metacritic critics.

```{r}
#| label: fig-rt-critic-opening-wknd
#| fig-cap: A visualization of the relationship between Rotten Tomatoes critic scores and opening weekend revenue.

movie_data |> 
  ggplot(aes(x = rotten_tomatoes_critics,
             y = opening_weekend_million)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x = "Rotten Tomatoes Critic Rating",
       y = "Opening Weekend Earnings (millions of $)",
       title = "Opening Weekend Earnings by Rotten Tomatoes Critic Rating",
       subtitle = "There is a weak positive association between a movie's Rotten Tomatoes critic score and its opening 
weekend revenue.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        legend.position = "top")
```

A movie's Rotten Tomatoes critic rating is typically released before the movie hits theaters, as critics sometimes have exclusive pre-release screenings. Thus, I was interested in exploring the extent to which the success of this rating influences the success of the movie's opening weekend revenue. @fig-rt-critic-opening-wknd shows, however, that the correlation between these two variables is not very strong, and relatively nonexistent. There is a very slight positive association, suggesting that to some extent, as a movie's Rotten Tomatoes critic rating increases, so does its opening weekend earnings. But, as this association is very weak and not significant at all, this means that the Rotten Tomatoes critic score does not have a drastic/direct impact on opening weekend revenue as I had initially thought.

```{r}
#| label: fig-ratings-script-type
#| fig-cap: The average IMDb, Metacritic, and Rotten Tomatoes critic ratings for each unique script type combination of Hollywood movies.

movie_data |> 
  filter(!is.na(script_type)) |> 
  group_by(script_type) |> 
  summarize(avg_rotten_tomatoes_critics = mean(rotten_tomatoes_critics, 
                                               na.rm = TRUE),
            avg_metacritc_critics = mean(metacritic_critics, 
                                         na.rm = TRUE),
            avg_im_db_rating = mean(im_db_rating, 
                                    na.rm = TRUE)) |> 
  gather(key = "rating_type", 
         value = "average_rating", 
         -script_type) |> 
  ggplot(aes(x = script_type, 
             y = average_rating, 
             fill = rating_type)) +
  geom_bar(stat = "identity", 
           position = "dodge", 
           color = "white",
           width = 1) +
  labs(title = "Average IMDb, Metacritic, and Rotten Tomatoes Critic Ratings by Script Type",
       subtitle = "A majority of script types are missing information about their average IMDb rating.",
       x = "Script Type",
       y = "Average Rating",
       fill = "Rating Type") +
  scale_fill_manual(values = c("avg_rotten_tomatoes_critics" = "salmon", 
                               "avg_metacritc_critics" = "lightblue", 
                               "avg_im_db_rating" = "lightgreen"),
                    labels = c(avg_rotten_tomatoes_critics = "Rotten Tomatoes Critics",
                               avg_metacritc_critics = "Metacritic Critics",
                               avg_im_db_rating = "IMDb")) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 90, hjust = 1),
        legend.position = "top")
```

@fig-ratings-script-type visualizes the average IMDb, Metacritic, and Rotten Tomatoes critic ratings for each of the unique script type combinations of Hollywood movies from 2007-2022. One chief idea to note is that the average IMDb rating is only available for 5 out of the 16 script types, revealing a great amount of missingness within this variable and making it difficult to reach a conclusion about the relationship between script type and average IMDb rating. For the other two rating variables, the script type with both the highest Metacritic and Rotten Tomatoes critic ratings is "documentary", suggesting that this script type is more favorable among these critics than other script types.

```{r}
#| label: fig-deviance-genre
#| fig-cap: The distribution of the deviance of audience vs. critic movie ratings, by genre.

movie_data |> 
  filter(!is.na(primary_genre)) |> 
  group_by(primary_genre) |> 
  summarize(average_deviance = mean(audience_vs_critics_deviance, 
                                    na.rm = TRUE)) |> 
  ggplot(aes(x = reorder(primary_genre, 
                         -average_deviance), 
             y = average_deviance,
             fill = primary_genre))  +
  labs(x = "Genre",
       y = "Audience vs. Critics Deviance",
       title = "Audience vs. Critics Ratings Deviance by Genre",
       subtitle = "Audience and critics have the lowest difference in ratings for the 'biography' genre, and the largest for 
the 'sci-fi' genre.") +
  geom_bar(stat = "identity") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        legend.position = "none",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1)) 
```

In this data set, "audience vs. critics deviance" refers to the difference in a movie's average of Rotten Tomatoes and Metacritic critic ratings and its average of Rotten Tomatoes and Metacritic audience ratings. A negative deviance means there was a higher audience rating than critic rating. In @fig-deviance-genre, a majority of the bars on the graph being in the negative axis means that for a majority of genres, audience rating groups gave out higher ratings than critic rating groups. This makes sense, given that in @fig-yearly-avg-ratings, it was concluded that audience rating groups tend to give out higher ratings than critic rating groups. Faceting by genre, the graph shows that the genre with the lowest absolute value deviance rating is the "biography" category. This suggests that audience and critic rating groups rated movies of this genre most similarly. On the other hand, the genre with the highest disparity in ratings is the "sci-fi" category, suggesting that audiences and critics differ in rating opinion the most for this genre.

```{r}
#| label: fig-company-deviance-genre
#| fig-cap: The distribution of the deviance of Rotten Tomatoes vs. Metacritic audience group movie ratings, by genre.

movie_data |> 
  filter(!is.na(primary_genre)) |> 
  group_by(primary_genre) |> 
  summarize(aveg_dev = mean(rotten_tomatoes_vs_metacritic_deviance, 
                                    na.rm = TRUE)) |> 
  ggplot(aes(x = reorder(primary_genre, 
                         -aveg_dev), 
             y = aveg_dev,
             fill = primary_genre))  +
  labs(x = "Genre",
       y = "Deviance",
       title = "Rotten Tomatoes vs. Metacritic Audience Ratings Deviance by Genre",
       subtitle = "The 'sci-fi' genre has the lowest deviance, and the 'biography' genre has the highest.") +
  geom_bar(stat = "identity") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        legend.position = "none",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1)) 
```

In @fig-company-deviance-genre, the deviances in Rotten Tomatoes audience ratings and Metacritic audience ratings is explored by genre. A positive deviance means there was a higher average Rotten Tomatoes audience score than Metacritic score. With all of the bars in this graph in the positive axis except for the fantasy genre, this suggests that Rotten Tomatoes audience users gave out higher ratings for movies than the Metacritic audience rating group in all genres except fantasy. Moreover, @fig-company-deviance-genre interestingly displays the exact opposite findings of the lowest and highest deviances that were concluded in @fig-deviance-genre. This time, the genre with the lowest absolute value deviance is the "sci-fi" category, suggesting that Rotten Tomatoes and Metacritic audiences rated movies in this category most similarly, and the genre that the Rotten Tomatoes and Metacritic audiences differed in ratings the highest in is the "biography" category. With this repetition in extreme deviances for the "sci-fi" and "genre" categories from both @fig-company-deviance-genre and @fig-deviance-genre, this could suggest that these two categories are the two genres that are the most varied in opinion.

```{r}
#| label: fig-critic-vs-aud-dom-gross
#| fig-cap: A visualization of the relationship between audience and critic ratings with domestic gross for each movie genre category.

# critics
critic_rating_dom_gross_genre <- movie_data |> 
  filter(!is.na(primary_genre)) |> 
  ggplot(aes(x = average_critics, 
             y = domestic_gross_million,
             color = primary_genre)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(x = "Average Critic Rating",
       y = "Domestic Gross (millions of $)",
       title = "The Relationship of Average Rotten Tomatoes & 
Metacritic Critic Ratings and Domestic Gross, 
by Genre",
       subtitle = "The 'action' genre has the highest correlation between the 
two variables.",
       color = "Genre") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 10),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 8.5),
        legend.position = "bottom",
        legend.text = element_text(size = 5),   
        legend.title = element_text(size = 7.5),
        axis.text.x = element_text(size = 9),
        axis.text.y = element_text(size = 9))+
  xlim(0, 100) +
  ylim(0, 800)


# audience
aud_rating_dom_gross_genre <- movie_data |> 
  filter(!is.na(primary_genre)) |> 
  ggplot(aes(x = average_audience, 
             y = domestic_gross_million,
             color = primary_genre)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(x = "Average Audience Rating",
       y = "Domestic Gross (millions of $)",
       title = "The Relationship of Average Rotten Tomatoes & 
Metacritic Audience Ratings and Domestic Gross, 
by Genre",
       subtitle = "The 'action' genre has the highest correlation between the 
two variables.",
       color = "Genre") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 10),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 8.5),
        legend.position = "bottom",
        legend.text = element_text(size = 5),   
        legend.title = element_text(size = 7.5),
        axis.text.x = element_text(size = 9),
        axis.text.y = element_text(size = 9)) +
  xlim(0, 100) +
  ylim(0, 800)

critic_rating_dom_gross_genre + aud_rating_dom_gross_genre
```

@fig-critic-vs-aud-dom-gross seeks to explore the relationship between both critic groups' ratings and domestic gross, as well as how the genre variable plays into this relationship. Overall, there seems to be a positive correlation between a movie's rating and its domestic gross earnings. That is, as the rating of a movie increases, its domestic gross revenue also increases. However, this correlation seems to be stronger/steeper for audience rating groups than critic rating groups, suggesting that as audience ratings increase, the domestic gross earnings increase at a higher rate than they would with critic ratings. When looking at this relationship through the lens of the different genres, the "action" genre has the steepest correlation for both plots, but it is again steeper for audience rating. This suggests that for action-type movies specifically, as their movie rating increases, the amount of domestic gross revenue earned for this type of category is greater than other movie genres. However, this domestic gross earning is greater for audience ratings as they increase for action movies, as compared to critic ratings of action movies.

```{r}
#| label: fig-critic-vs-aud-distributor
#| fig-cap: A visualization of the movie distributors with the ten highest average critic and average audience ratings.


aud_ratings_distributor <- movie_data |> 
  group_by(distributor) |> 
  summarize(avg_aud = mean(average_audience, 
                           na.rm = TRUE)) |> 
  slice_head(n = 10) |> 
  ggplot(aes(x = reorder(distributor, 
                         -avg_aud),  
             y = avg_aud,
             fill = distributor)) +
  geom_bar(stat = "identity") +
  labs(x = "Distributor",
       y = "Average Audience Rating",
       title = "Top 10 Movie Distributors with Highest Average 
Rotten Tomatoes & Metacritic Audience Ratings",
       subtitle = "Atlas Distribution Company has the highest 
audience ratings.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 10),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 9),
        legend.position = "none",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1)) +
  ylim(0, 95)

critic_ratings_distributor <- movie_data |> 
  group_by(distributor) |> 
  summarize(avg_critic = mean(average_critics, 
                              na.rm = TRUE)) |> 
  slice_head(n = 10) |> 
  ggplot(aes(x = reorder(distributor, 
                         -avg_critic),  
             y = avg_critic,
             fill = distributor)) +
  geom_bar(stat = "identity") +
  labs(x = "Distributor",
       y = "Average Critic Rating",
       title = "Top 10 Movie Distributors with Highest Average 
Rotten Tomatoes & Metacritic Critic Ratings",
       subtitle = "A24 has the highest critic ratings.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 10),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 9),
        legend.position = "none",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1)) +
  ylim(0, 95)

critic_ratings_distributor + aud_ratings_distributor
```

@fig-critic-vs-aud-distributor displays the movie distributors with the highest average Rotten Tomatoes and Metacritic ratings, for both audience and critic rating groups. The movie distributing company with the highest average critic rating is "A24", and the highest average audience rating was received by "Atlas Distribution Company". This could suggest that movies released by A24 were favored the most among critics, and movies released by Atlas Distribution Company were favored the most among audiences.

```{r}
#| label: fig-critic-aud-pcnt-abroad
#| fig-cap: A comparison of the relationships between critic and audiences ratings with the percent that a movie's revenue is earned from abroad audiences.

# ratings by percent earned abroad
critic_pcnt_abroad <- movie_data |> 
  ggplot(aes(x = average_critics, 
             y = of_gross_earned_abroad)) +
  geom_point() +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(x = "Average Critic Rating",
       y = "% of Gross Earned Abroad",
       title = "Percent of Gross Earned Abroad by Critic Ratings",
       subtitle = "There is no correlation between the two variables.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.subtitle = element_text(size = 8),
        plot.title.position = "plot")

aud_pcnt_abroad <- movie_data |> 
  ggplot(aes(x = average_audience, 
             y = of_gross_earned_abroad)) +
  geom_point() +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(x = "Average Audience Rating",
       y = "% of Gross Earned Abroad",
       title = "Percent of Gross Earned Abroad by Audience Ratings",
       subtitle = "There is no correlation between the two variables.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.subtitle = element_text(size = 8),
        plot.title.position = "plot")

critic_pcnt_abroad + aud_pcnt_abroad
```

In @fig-critic-aud-pcnt-abroad, the potential relationship of the audience and critic rating groups with the percent of a movie's gross earnings that are earned abroad is explored. However, we see that there is virtually no correlation between the variables, although there is the slightest positive correlation between audience ratings and the percentage of a movie's gross earned abroad. This could suggest that critic ratings have practically no link with the percent that a movie earns in its theaters abroad, but the audience ratings do seem to have a slightly stronger correlation with the percent earned abroad variable, suggesting that audience ratings may have the slightest connection to this variable, but it is not to a significant degree.

## Variable 2: Opening Weekend Revenue

A movie's opening weekend revenue refers to the total box office earnings that the film earned during its first weekend of release in theaters.

```{r}
#| label: fig-yearly-opening-wknd
#| fig-cap: A visualization of the change in yearly average opening weekend revenue for Hollywood movies from 2007-2022.

year_opening_success <- movie_data |> 
  group_by(year) |> 
  summarize(mean_opening_success = round(mean(opening_weekend_million,
          na.rm = TRUE)))  |> 
  arrange(desc(mean_opening_success)) 

potential_outliers <- year_opening_success |>
  filter(mean_opening_success == 20 | mean_opening_success == 9)

ggplot(year_opening_success,
       aes(x = year, 
           y = mean_opening_success)) +
  geom_line() +
  geom_point() +
  geom_text_repel(data = potential_outliers, 
                  aes(label = "")) +
  geom_label(data = data.frame(label = "2008 Great 
 Recession"),
             aes(x = 2007, 
                 y = 16.4, 
                 label = label),
             fill = "gray", 
             alpha = 0.2, 
             hjust = 0, 
             vjust = 0) +
  geom_label(data = data.frame(label = "COVID-19 
 Pandemic"),
             aes(x = 2018.9, 
                 y = 5.4, 
                 label = label),
             fill = "gray", 
             alpha = 0.2, 
             hjust = 0, 
             vjust = 0) +
  geom_point(data = potential_outliers, 
             color = "red") +
  geom_point(
    data = potential_outliers,
    color = "red", 
    size = 3, 
    shape = "circle open") +
  labs(x = "Year", 
       y = "Mean Opening Weekend Earnings (millions of $)", 
       title = "Average Opening Weekend Earnings for Hollywood Movies from 2007-2022",
       subtitle = "2008 is heavily impacted by the Great Recession. 2020 is heavily impacted by the 
COVID-19 pandemic.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  ylim(3, 28) +
  scale_x_continuous(breaks = seq(min(year_opening_success$year),
                                  max(year_opening_success$year), 
                                  by = 2))

```

@fig-yearly-opening-wknd visualizes the change in the mean opening weekend earnings (in millions) for Hollywood movies from 2007-2022. As can be seen by the graph, there are two distinct low points on the graph corresponding to the years 2008 and 2020, and these drops can be explained by the economic state of the country during those years. In 2008, the country experienced a Great Recession of economic downturn, greatly impacting the film industry. This economic crisis led to a dramatic decline in consumer spending and movie production, possibly leading to the drop in mean opening weekend earnings that we see in the graph for this year. In 2020, we see a significantly more drastic drop in mean opening weekend revenue, as the COVID-19 pandemic led to a nationwide shut down/capacity limit of movie theaters. With these conditions, there was a dramatic decline in movie theater ticket sales and thus a dramatic drop in the mean opening weekend revenue of movies released during the pandemic, as shown in the graph. These findings are certainly something to keep in mind throughout this variable analysis, as the opening weekend revenue is highly impacted by economic crises such as the 2008 Great Recession and the 2020 COVID-19 pandemic.

```{r}
#| label: fig-budget-rcvry-opening-wknd
#| fig-cap: The relationship between a movie's earnings during the first weekend of its release and its overall budget recovery earnings, compared across genres and script types.


## Exploration 2 by genre
opening_wknd_budget_rcvry_genre <- movie_data |> 
  filter(!is.na(primary_genre)) |> 
  mutate(budget_recovered_millions = round(budget_million * (budget_recovered / 100))) |> 
  ggplot(aes(x = opening_weekend_million, 
             y = budget_recovered_millions,
             color = primary_genre)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(x = "Opening Weekend Earnings (millions of $)",
       y = "Budget Recovery Earnings (millions of $)",
       title = "Budget Recovery by Opening Weekend 
Earnings by for Each Genre",
       subtitle = "The 'adventure' genre has the steepest correlation.",
       color = "Genre") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 7),
        legend.text = element_text(size = 7),
        legend.title = element_text(size = 6),
        axis.title.x = element_text(size = 6),
        axis.title.y = element_text(size = 6)) +
  ylim(0, 2000)


opening_wknd_budget_rcvry_script_type <- movie_data |> 
  filter(!is.na(script_type)) |> 
  mutate(budget_recovered_millions = round(budget_million * (budget_recovered / 100))) |> 
  ggplot(aes(x = opening_weekend_million, 
             y = budget_recovered_millions,
             color = script_type)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(x = "Opening Weekend Earnings (millions of $)",
       y = "Budget Recovery Earnings (millions of $)",
       title = "Budget Recovery by Opening Weekend 
Earnings by for Each Script Type",
       subtitle = "The 'remake' script type has the steepest correlation.",
       color = "Script Type") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 7),
        legend.text = element_text(size = 7),
        legend.title = element_text(size = 6),
        axis.title.x = element_text(size = 6),
        axis.title.y = element_text(size = 6)) +
  ylim(0, 2000)

opening_wknd_budget_rcvry_genre + opening_wknd_budget_rcvry_script_type
```

@fig-budget-rcvry-opening-wknd explores the relationship between a movie's opening weekend revenue and how much it earns to recover its production cost (budget recovery), categorized by script type and genre. Overall, there is a clear strong, positive correlation between opening weekend revenue and budget recovery, suggesting that as the amount of money a movie earns during the first weekend of its release in theaters increases, the amount of money it will earn to recover its budget will also increase. However, this correlation varies between each specific genre and script type. In examining genre, the 'adventure' category has the highest correlation. This may suggest that out of all movie genres, the adventure category earns more of its budget back as its opening weekend increases. In examining script type relationships, the 'remake' script type has the highest correlation, also suggesting that remakes earn a higher amount to recover their budget as their opening weekend earnings increase.

```{r}
#| label: fig-opening-wknd-by-genre-script-type
#| fig-cap: The top 5 movies genres and script types that earned the most revenue during their opening weekends.
genre_opening_wknd_plot <- movie_data |> 
  group_by(genre) |> 
  summarize(mean_opening_success = mean(opening_weekend_million)) |> 
  arrange(desc(mean_opening_success)) |> 
  slice_head(n = 5) |> 
  ggplot(aes(x = fct_infreq(genre, 
                             mean_opening_success), 
             y = mean_opening_success,
             fill = genre)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 5 Genres with Highest Opening 
Weekend Earnings",
       subtitle = "The 'sci-fi, fantasy' genre has the highest 
average opening weekend revenue.",
       x = "Genre",
       y = "Mean Opening Weekend Earnings (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        axis.title.y = element_text(size = 6),
        legend.position = "none") 

scripttype_opening_wknd_plot <- movie_data |> 
  group_by(script_type) |> 
  summarize(mean_opening_success = mean(opening_weekend_million)) |> 
  arrange(desc(mean_opening_success)) |> 
  slice_head(n = 5) |> 
  ggplot(aes(x = fct_infreq(script_type, 
                             mean_opening_success), 
             y = mean_opening_success,
             fill = script_type)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 5 Script Types with 
Highest Opening Weekend Earnings",
       subtitle = "The 'sequel, adaptation' script type has the 
highest average opening weekend revenue.",
       x = "Script Type",
       y = "Mean Opening Weekend Earnings (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        axis.title.y = element_text(size = 6),
        legend.position = "none")  +
  scale_fill_viridis_d() 

genre_opening_wknd_plot + scripttype_opening_wknd_plot
```

@fig-opening-wknd-by-genre-script-type displays that the genre combination that earned the greatest average revenue during its opening weekend of release is sci-fi & fantasy, and the script type combination that earned the greatest average revenue during its opening weekend of release is sequel & adaptation. This suggests that the movies categorized as a sci-fi fantasy genre hybrid earned more during the first weekend of their release than other genre combinations, and movies categorized as a sequel adaptation script type hybrid also earned that title.

```{r}
#| label: fig-opening-wknd-oscar
#| fig-cap: The disribution of opening weekend revenue for movies that have won at least one Oscar award and movies who have won 0 Oscars.
movie_data |> 
  filter(!is.na(oscar_winners)) |> 
  ggplot(aes(x = opening_weekend_million, y = oscar_winners)) +
  geom_boxplot() +
  labs(title = "Distribution of Opening Weekend Revenue for Oscar-winning Movies and 
Movies with 0 Oscars",
       subtitle = "Oscar winning movies have a lower average of opening weekend revenue earnings.",
       x = "Opening Weekend Revenue (in millions of $)",
       y = "Oscar Winner") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot")
```

@fig-opening-wknd-oscar shows that Hollywood movies that have won at least one Oscar award or greater have an average opening weekend revenue that is actually less than movies that have not won any Oscars. This could suggest that the mean opening weekend success of a movie does not correlate with winning an Oscar, and these two variables are unrelated to one another. In other words, having a high opening weekend revenue may not increase a movie's chance of winning an Oscar.

```{r}
#| label: fig-opening-wknd-dom-for
#| fig-cap: The relationship between a Hollywood movie's opening weekend revenue and both its domestic and foreign gross earnings.

opening_wknd_domgross <- movie_data |> 
  ggplot(aes(x = opening_weekend_million, 
             y = domestic_gross_million)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Domestic Gross by Opening Weekend Revenue",
       subtitle = "There is a strong positive association between the two 
variables.",
       x = "Opening Weekend Revenue (millions of $)",
       y = "Domestic Gross (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", 
                                  size = 10.5),
        plot.subtitle = element_text(size = 9),
        plot.title.position = "plot")

opening_wknd_forgross <- movie_data |> 
  ggplot(aes(x = opening_weekend_million, 
             y = foreign_gross_million)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = " Foreign Gross by Opening Weekend Revenue",
       subtitle = " There is a strong positive association between the two 
 variables.",
       x = "Opening Weekend Revenue (millions of $)",
       y = "Foreign Gross (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 10.5),
        plot.subtitle = element_text(size = 9),
        plot.title.position = "plot")

opening_wknd_domgross + opening_wknd_forgross
```

@fig-opening-wknd-dom-for displays very strong, positive correlations for both associations of domestic gross by opening weekend revenue and foreign gross by opening weekend revenue. This suggests that a Hollywood movie's performance during its opening weekend of release has a direct positive association with its overall domestic and foreign grosses. That is, as opening weekend earnings success increases, so will domestic and foreign gross successes. Additionally, the correlation between opening weekend revenue and domestic gross seems to be slightly steeper than the correlation between opening weekend revenue and foreign gross, suggesting that opening weekend revenue performance has a slightly greater impact on its domestic gross performance than it does on its foreign gross performance.

```{r}
#| label: fig-distr-opening-wknd-success
#| fig-cap: The top 10 most successful movie distribution companies in terms of average opening weekend revenue success.

movie_data |> 
  filter(!is.na(distributor)) |> 
  group_by(distributor) |> 
  summarize(avg_opening_wnkd = mean(opening_weekend_million, na.rm = TRUE)) |> 
  arrange(desc(avg_opening_wnkd)) |> 
  slice_head(n = 10) |> 
  ggplot(aes(x = reorder(distributor, 
                         -avg_opening_wnkd),
             y = avg_opening_wnkd,
             fill = distributor)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 10 Movie Distributors with Greatest Average Opening Weekend Success",
       subtitle = "Walt Disney Studios has the most opening weekend earnings.",
       x = "Distributor",
       y = "Average Opening Weekend Revenue (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        legend.position = "none",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        axis.title.y = element_text(size = 9))
```

In examining the top distribution companies based on opening weekend performance, @fig-distr-opening-wknd-success displays that the "Walt Disney Studios" movie distribution company has earned a mean opening weekend revenue that is significantly greater than other movie distributors. This suggests that movies that are released by this company have earned revenue during their opening weekends of being in theaters at a rate significantly greater than movies released by other companies. However, as mentioned in the "Data Overview and Quality" section, the movie distributor company variable contains a great amount of missingness, so this graph may not be an accurate representation of the distributors and their greatest opening weekend successes for all of the movies in the data set.

```{r}
#| label: fig-opening-wknd-audience
#| fig-cap: A visualization of the correlation between opening weekend revenue and Rotten Tomatoes audience scores.

movie_data |> 
  ggplot(aes(x = opening_weekend_million,
             y = rotten_tomatoes_audience)) +
  geom_point() +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(title = "Rotten Tomatoes Audience Score by Opening Weekend Revenue",
       subtitle = "There is a positive relationship between the two variables.",
       x = "Opening Weekend (millions of $)",
       y = "Rotten Tomatoes Audience Score") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot")
```

In @fig-rt-critic-opening-wknd, the relationship between the Rotten Tomatoes critic rating and a movie's opening weekend success was explored, as Rotten Tomatoes critic ratings are usually revealed before the release of a movie. Now, @fig-opening-wknd-audience follows this analysis by exploring how the opening weekend success of a movie correlates with its Rotten Tomatoes audience ratings, as audience ratings are typically made after a movie hits the theaters. While there was not a very discernible relationship between the two variables in @fig-rt-critic-opening-wknd, @fig-opening-wknd-audience shows a distinct, positive relationship between opening weekend revenue and Rotten Tomatoes audience score, suggesting that the more successful the opening weekend of a movie is, the higher the movie's Rotten Tomatoes audience score will be. This establishes a relationship between opening weekend revenue and Rotten Tomatoes audience score, while the relationship between Rotten Tomatoes critic score with opening weekend revenue is definitely not as significant.

## Variable 3: Domestic, Foreign, & Worldwide Gross

A Hollywood movie's domestic gross refers to the total box office revenue earned by US audiences, foreign gross is the total box office revenue earned by audiences outside of the US, and worldwide gross is the sum of domestic and foreign gross, representing the overall box office revenue generated by a Hollywood movie globally.

```{r}
#| label: fig-yearly-dom-gross
#| fig-cap: A visualization of the change in yearly domestic gross for Hollywood movies from 2007-2022.

year_dom_gross <- movie_data |> 
  group_by(year) |> 
  summarize(mean_dom_gross = round(mean(domestic_gross_million, na.rm = TRUE)))  |> 
  arrange(desc(mean_dom_gross)) 

potential_outlier <- year_dom_gross |>
  filter(mean_dom_gross == 25 | mean_dom_gross == 62)

ggplot(year_dom_gross, aes(x = year, y = mean_dom_gross)) +
  geom_line() +
  geom_point() +
  geom_text_repel(data = potential_outlier, 
                  aes(label = "")) +
  geom_label(data = data.frame(label = "2008 Great 
 Recession"),
             aes(x = 2007, 
                 y = 48, 
                 label = label),
             fill = "gray", 
             alpha = 0.2, 
             hjust = 0, 
             vjust = 0) +
  geom_label(data = data.frame(label = "COVID-19 
 Pandemic"),
             aes(x = 2019, 
                 y = 10.5, 
                 label = label),
             fill = "gray", 
             alpha = 0.2, 
             hjust = 0, 
             vjust = 0) +
  geom_point(data = potential_outlier, 
             color = "red") +
  geom_point(
    data = potential_outlier,
    color = "red", 
    size = 3, 
    shape = "circle open") +
  labs(x = "Year", 
       y = "Mean Domestic Gross (millions of $)", 
       title = "Average Domestic Gross for Hollywood Movies from 2007-2022",
       subtitle = "There are significant drops in the years 2008 and 2020.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  ylim(0, 100) +
  scale_x_continuous(breaks = seq(min(year_dom_gross$year), max(year_dom_gross$year), by = 2))
```

@fig-yearly-dom-gross visualizes the change in the yearly average domestic gross (in millions) for Hollywood movies from 2007-2022. Just as in @fig-yearly-opening-wknd, there are significant drops for the years 2008 and 2020, also due to the economy of the country during those years. With the 2008 Great Recession, declines in consumer spending due to the economic downturn directly impacted the total box office revenue of movies. With the 2020 COVID-19 pandemic, quarantining and the closing of movie theaters also led to declines in consumer spending and a direct decline in gross domestic revenue for movies. Like the opening weekend revenue variable, the domestic gross variable is heavily impacted by economic crises such as the 2008 Great Recession and the 2020 COVID-19 pandemic.

```{r}
#| label: fig-gross-correlation
#| fig-cap: A visualization of the relationship between a Hollywood movie's US box office revenue and revenue earned abroad.

movie_data |> 
  ggplot(aes(x = domestic_gross_million,
             y = foreign_gross_million)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Relationship Between Domestic and Foreign Gross",
       subtitle = "There is a strong positive correlation between the two variables.",
       x = "Domestic Gross (millions of $)",
       y = "Foreign Gross (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") 
```

@fig-gross-correlation displays a direct and strong positive correlation between the domestic gross earnings and foreign gross earnings of Hollywood movies. In other words, as the domestic gross earnings of a movie increase, its foreign gross earnings also increase. This suggests that US and foreign audiences have similar preferences in movie popularity.

```{r}
#| label: fig-gross-genre-dist
#| fig-cap: The distributions of domestic and foreign gross for each genre of Hollywood movies.

gross_domestic_genre <- movie_data |> 
  filter(!is.na(domestic_gross_million) & 
           !is.na(primary_genre) & 
           primary_genre != "")  |> 
  ggplot(aes(x = fct_reorder(primary_genre, 
                             -domestic_gross_million), 
             y = domestic_gross_million, 
             fill = primary_genre)) +
  geom_boxplot() +
  labs(title = "Genre-specific Domestic Gross 
Performance",
       subtitle = "The 'sci-fi' category has the best performance.",
       x = "Genre",
       y = "Domestic Gross (millions of $)",
       fill = "Primary Genre") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none")

gross_foreign_genre <- movie_data |> 
  filter(!is.na(foreign_gross_million) & 
           !is.na(primary_genre) & 
           primary_genre != "")  |> 
  ggplot(aes(x = reorder(primary_genre, 
                         -foreign_gross_million), 
             y = foreign_gross_million, 
             fill = primary_genre)) +
  geom_boxplot() +
  labs(title = "Genre-specific Foreign Gross 
Performance",
       subtitle = "The 'action' and 'adventure' categories have the
best performance.",
       x = "Genre",
       y = "Foreign Gross (millions of $)",
       fill = "Primary Genre") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none") +
  ylim(0, 800)

gross_domestic_genre + gross_foreign_genre
```

@fig-gross-genre-dist seeks to explore another comparison of movie preference behavior between domestic and foreign audiences, this time by comparing gross performance among movie genres. In determining the most popular genres by highest average gross revenue between the two audiences, the "sci-fi" category has the best domestic performance, while the "action" and "adventure" categories are tied for the best foreign performance. This suggests that there is a difference in movie genre popularity between the two audiences, in that US movie audiences have a high preference for sci-fi category movies, while foreign movie audiences have a high preference for action and adventure movies. A sci-fi movie may perform better in the US than compared to foreign movie theaters, and action and adventure movies may perform better in foreign movie theaters.

```{r}
#| label: fig-gross-scripttype-dist
#| fig-cap: The distributions of domestic and foreign gross for each script type of Hollywood movies.


gross_domestic_script_type <- movie_data |> 
  filter(!is.na(domestic_gross_million) & 
           !is.na(script_type) & 
           script_type != "")  |> 
  ggplot(aes(x = fct_reorder(script_type, 
                             -domestic_gross_million), 
             y = domestic_gross_million, 
             fill = script_type)) +
  geom_boxplot() +
  labs(title = "Domestic Gross Performance by Script Type",
subtitle = "The 'sequel, adaption' script type has the best performance.",
x = "Script Type",
y = "Domestic Gross (millions of $)",
fill = "Script Type") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 11),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 9),
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none")

gross_foreign_script_type <- movie_data |> 
  filter(!is.na(foreign_gross_million) & 
           !is.na(script_type) & 
           script_type != "")  |> 
  ggplot(aes(x = reorder(script_type, 
                         -foreign_gross_million), 
             y = foreign_gross_million, 
             fill = script_type)) +
  geom_boxplot() +
  labs(title = "Foreign Gross Performance by Script Type",
subtitle = "The 'sequel, adaptation' script type has the best performance.",
x = "Script Type",
y = "Foreign Gross (millions of $)",
fill = "Script Type") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 11),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 9),
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none") 

gross_domestic_script_type + gross_foreign_script_type
```

Similar to @fig-gross-genre-dist, @fig-gross-scripttype-dist compares the movie preference behavior between domestic and foreign audiences, this time by script type popularity. According to the distributions, the "sequel, adaptation" script type has the best performance for both domestic and foreign audiences. Unlike @fig-gross-genre-dist, which revealed a disparity between the domestic and foreign audiences, @fig-gross-scripttype-dist reveals a way in which they are similar as they both have a stronger preference for "sequel, adaptation" movies over other script types. This category performs equally successfully among both domestic and foreign audiences by bringing in the most average gross revenues.

```{r}
#| label: fig-dom-for-gross-distributor
#| fig-cap: A visualization of the top 5 movie distributors with the highest domestic and foreign gross earnings.

dom_gross_distributor <- movie_data |> 
  filter(!is.na(distributor)) |> 
  group_by(distributor) |> 
  summarize(avg_dom_gross = mean(domestic_gross_million, 
                                 na.rm = TRUE)) |> 
  arrange(desc(avg_dom_gross)) |> 
  slice_head(n = 5) |> 
  ggplot(aes(x = reorder(distributor, 
                         -avg_dom_gross), 
             y = avg_dom_gross)) +
  geom_bar(stat = "identity", 
           fill = "skyblue") +
  labs(title = "Top 5 Movie Distributors with the Highest 
Domestic Gross",
       subtitle = "Walt Disney Studios had the most successful domestic gross 
performance.",
       x = "Distributor",
       y = "Average Domestic Gross (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 12),
        plot.subtitle = element_text(size = 9),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        axis.title.y = element_text(size = 9)) +
  ylim(0, 800)


for_gross_distributor <- movie_data |> 
  filter(!is.na(distributor)) |> 
  group_by(distributor) |> 
  summarize(avg_for_gross = mean(foreign_gross_million, 
                                 na.rm = TRUE)) |> 
  arrange(desc(avg_for_gross)) |> 
  slice_head(n = 5) |> 
  ggplot(aes(x = reorder(distributor, 
                         -avg_for_gross), 
             y = avg_for_gross)) +
  geom_bar(stat = "identity", 
           fill = "lightgreen") +
  labs(title = "Top 5 Movie Distributors with the Highest 
Foreign Gross",
       subtitle = "Walt Disney Studios had the most successful foreign gross 
performance.",
       x = "Distributor",
       y = "Average Foreign Gross (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 12),
        plot.subtitle = element_text(size = 9),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        axis.title.y = element_text(size = 9)) +
  ylim(0, 800)


dom_gross_distributor + for_gross_distributor
```

As a final comparison of movie preference behavior between domestic and foreign audiences, @fig-dom-for-gross-distributor explores the movie distributors with the top 5 highest average domestic and foreign gross revenues. For both US and foreign audiences, the movie distributor with the most successful gross performance is Walt Disney Studios. This reveals a similarity between domestic and foreign audiences in that movies distributed by Walt Disney Studios are more popular (generate more gross revenue) than movies released by other distributors. However, like in @fig-distr-opening-wknd-success, there is a lot of missingness in the distributor variable, so this may not be accurate and there could be another company with a higher mean gross the Walt Disney Studios.

```{r}
#| label: fig-ww-gross-budget-rcvry
#| fig-cap: A visualization of the relationship between a Hollywood movie's worldwide gross revenue and the percent of its production budget that was recovered.

movie_data |> 
  filter(budget_recovered < 10000) |> 
  ggplot(aes(x = worldwide_gross_million,
             y = budget_recovered)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Relationship Between a Hollywood Movie's Worldwide Gross and the Percent 
of its Budget Recovered",
       subtitle = "There is a positive association between the two variables.",
       x = "Worldwide Gross (millions of $)",
       y = "Percent of Budget Recovered") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") 
```

In @fig-ww-gross-budget-rcvry, there is a clear positive relationship between a movie's worldwide gross earnings and the percentage of its budget that is recovered. This suggests that as the box office revenue of a movie increases, the amount that it earns to recovery its budget following its production/release into theaters also increases.

```{r}
#| label: fig-genres-pcnt-earned-abroad
#| fig-cap: The top 10 genres with a higher proportion of revenue from foreign audiences than domestic audiences.

movie_data |> 
  filter(!is.na(primary_genre) & !is.na(of_gross_earned_abroad)) |> 
  group_by(primary_genre) |> 
  summarize(avg_pcnt_abroad = mean(of_gross_earned_abroad, na.rm = TRUE)) |> 
  arrange(desc(avg_pcnt_abroad)) |> 
  slice_head(n = 10) |> 
  ggplot(aes(x = reorder(primary_genre,
                         -avg_pcnt_abroad),
             y = avg_pcnt_abroad,
             fill = primary_genre)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 10 Genres with the Most Percentage of Gross Earned Abroad",
       subtitle = "The 'sci-fi' category earns the most of its gross from foreign audiences.",
       x = "Genre",
       y = "% of Gross Earned Abroad") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 12),
        plot.subtitle = element_text(size = 9),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none")
```

In examining the top genres based on popularity proportions between domestic and foreign audiences, @fig-genres-pcnt-earned-abroad reveals that the "sci-fi" genre has the greatest percent of its gross earned abroad. This suggests that this category is more popular in foreign theaters than domestic theaters to a degree greater than other genres.

```{r}
#| label: fig-script-type-pcnt-earned-abroad
#| fig-cap: The top 10 script types that have a higher proportion of revenue from foreign audiences than domestic audiences.

movie_data |> 
  filter(!is.na(script_type) & !is.na(of_gross_earned_abroad)) |> 
  group_by(script_type) |> 
  summarize(avg_pcnt_abroad = mean(of_gross_earned_abroad, na.rm = TRUE)) |> 
  arrange(desc(avg_pcnt_abroad)) |> 
  slice_head(n = 10) |> 
  ggplot(aes(x = reorder(script_type,
                         -avg_pcnt_abroad),
             y = avg_pcnt_abroad,
             fill = script_type)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 10 Script Types with the Most Percentage of Gross Earned Abroad",
       subtitle = "The 'based on a true story, remake' & 'sequel, adaptation' script types both earn the highest proportion of their gross from foreign
audiences.",
       x = "Script Type",
       y = "% of Gross Earned Abroad") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 12),
        plot.subtitle = element_text(size = 8.6),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1,
                                   size = 6.5),
        legend.position = "none")
```

In examining the top script types based on their domestic vs. foreign gross revenue makeups, @fig-script-type-pcnt-earned-abroad reveals that the "based on a true story, remake" and "sequel, adaptation" script types are tied for having the highest proportion of their gross being contributed from foreign audiences. This suggests that movies with these script type categories earn more abroad than domestically compared to the other script types.

## Variable 4: Budget & Budget Recovery

A movie's budget refers to total amount of money allocated for the production of the film, including visual effects, marketing, actor salary, set costs, etc. Budget recovery refers to the total amount of money that the film was able to earn in order to earn back these production expenses.

```{r}
#| label: fig-yearly-movie-budget
#| fig-cap: A visualization of the change in average production budgets for Hollywood movies from 2007-2022.

yearly_movie_budget <- movie_data |> 
  group_by(year) |> 
  summarize(mean_movie_budget = round(mean(budget_million, 
                                           na.rm = TRUE)))  |> 
  arrange(desc(mean_movie_budget)) 

potential_budget_outliers <- yearly_movie_budget |>
  filter(mean_movie_budget == 47 | mean_movie_budget == 49)

ggplot(yearly_movie_budget, aes(x = year, 
                                y = mean_movie_budget)) +
  geom_line() +
  geom_point() +
  geom_text_repel(data = potential_budget_outliers, 
                  aes(label = "")) +
  geom_label(data = data.frame(label = "2008 Great 
 Recession"),
 aes(x = 2007, 
     y = 39, 
     label = label),
 fill = "gray", 
 alpha = 0.2, 
 hjust = 0, 
 vjust = 0) +
  geom_label(data = data.frame(label = "COVID-19 
 Pandemic"),
 aes(x = 2019, 
     y = 37, 
     label = label),
 fill = "gray", 
 alpha = 0.2, 
 hjust = 0, 
 vjust = 0) +
  geom_point(data = potential_budget_outliers, 
             color = "red") +
  geom_point(
    data = potential_budget_outliers,
    color = "red", 
    size = 3, 
    shape = "circle open") +
  labs(x = "Year", 
       y = "Mean Budget (millions of $)", 
       title = "Average Movie Budgets for Hollywood Movies from 2007-2022",
       subtitle = "There are significant drops in the years 2008 and 2020.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  ylim(0, 70) +
  scale_x_continuous(breaks = seq(min(yearly_movie_budget$year),
                                  max(yearly_movie_budget$year),
                                  by = 2))
```

@fig-yearly-movie-budget follows the same patterns as @fig-yearly-opening-wknd and @fig-yearly-dom-gross, showing that the variable of movie budget is also highly impacted by economic crises. In this graph, there are also two distinct low points corresponding to the years 2008 and 2020. With the 2008 Great Recession, financial challenges could have resulted in cost-cutting measures and a more stringent approach to budgeting for movie distributors, leading to a lower average movie budget for that year. With the 2020 COVID-19 pandemic and quarantine, film studios may have altered their production strategies of their movies by delaying the start of filmmaking, leading to an overall decline in film production and thus a decline in mean budgets for that year. From these three similar variable findings, there seems to be a common trend that a movie's success is greatly impacted by the economy.

```{r}
#| label: fig-opening-wknd-by-budget
#| fig-cap: The correlation between a Hollywood movie's production budget and the variables of opening weekend revenue and worldwide gross revenue.

budget_opening_wknd <- movie_data |> 
  ggplot(aes(x = budget_million, y = opening_weekend_million)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x = "Movie Budget (millions of $)",
       y = "Opening Weekend Earnings (millions of $)",
       title = "Opening Weekend Revenue by Movie Budget",
       subtitle = "There is a direct positive association between the 
two variables.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", 
                                  size = 11),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 10))

budget_ww_gross <- movie_data |> 
  ggplot(aes(x = budget_million, y = worldwide_gross_million)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x = "Movie Budget (millions of $)",
       y = "Worldwide Gross (millions of $)",
       title = "Worldwide Gross by Movie Budget",
       subtitle = "There is a direct positive association between the 
two variables.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 11),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 10))

budget_opening_wknd + budget_ww_gross
```

In @fig-opening-wknd-by-budget, there is a clear positive association between a Hollywood movie's budget and its earnings both during its opening weekend of release and overall earnings worldwide. This suggests that, on average, movies with higher production budgets tend to achieve greater box office revenue success. It can be concluded that movie budget is closely related to the variables of opening weekend revenue and worldwide gross, in that as the budget of movies increases, its opening weekend revenue earnings and worldwide gross revenue earnings also increase.

```{r}
#| label: fig-budget-genre
#| fig-cap: The distribution of movie budgets for each genre category.

movie_data |> 
  filter(!is.na(budget_million) & 
           !is.na(primary_genre) & 
           primary_genre != "")  |> 
  ggplot(aes(x = reorder(primary_genre, 
                         -budget_million), 
             y = budget_million, 
             fill = primary_genre)) +
  geom_boxplot() +
  labs(title = "Genre-Specific Movie Budgets",
subtitle = "The 'fantasy' genre has the highest average production budget.",
x = "Genre",
y = "Average Budget (millions of $)",
fill = "Primary Genre") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none")
```

@fig-budget-genre visualizes the distribution of movie production budgets for each of the genre categories, with the fantasy genre having the highest average budget. This could be due to the fact that the production of fantasy movies usually involves elaborate visual effects, intricate makeup/costumes, computer-generated imagery (CGI), and other advanced technologies to create mythical worlds and landscapes, thus requiring substantial financial investment in technology, skilled artists, and post-production processes that contribute to an overall high average budget.

```{r}
#| label: fig-budget-script-type
#| fig-cap: The distribution of movie budgets for each script type category.

movie_data |> 
  filter(!is.na(budget_million) & 
           !is.na(script_type) & 
           script_type != "")  |> 
  ggplot(aes(x = reorder(script_type, 
                         -budget_million), 
             y = budget_million, 
             fill = script_type)) +
  geom_boxplot() +
  labs(title = "Movie Budgets by Script Type",
       subtitle = "The 'sequel, adaptation' script type has the highest average production budget.",
       x = "Script Type",
       y = "Average Budget (millions of $)") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none")
```

@fig-budget-script-type shows the distributions of movie budgets for each script type category of Hollywood movies, with the "sequel, adaptation" having the highest average movie budget. So far, this script type category has won superlatives for many of the analyses in this EDA-- for example, @fig-gross-scripttype-dist revealed that the "sequel, adaptation" has the greatest average domestic and foreign gross, and @fig-opening-wknd-by-genre-script-type revealed that this same category earned the greatest average revenue during the opening weekend of its release. Given our previous findings and established understanding of the correlations between budget and the opening weekend revenue and gross variables, these findings make sense. In @fig-opening-wknd-by-budget, it was concluded that there exists a direct, positive association between a Hollywood movie's budget and its gross earnings, both during opening weekend and worldwide (foreign + gross). Thus, if the "sequel, adaptation" has the highest average movie budget, then it should also have the title of greatest domestic and foreign gross and opening weekend revenue, and that is exactly what has been found thus far.

```{r}
#| label: fig-budget-distributor
#| fig-cap: The movie distribution companies with the ten highest average production budgets.

movie_data |> 
  filter(!is.na(budget_million) & 
           !is.na(distributor)) |> 
  group_by(distributor) |> 
  summarize(mean_budget = round(mean(budget_million, 
                                     na.rm = TRUE))) |> 
  arrange(desc(mean_budget)) |>  
  slice_head(n = 10) |> 
  ggplot(aes(x = reorder(distributor,
                         -mean_budget),
             y = mean_budget,
             fill = distributor)) +
  geom_bar(stat = "identity") +
  labs(x = "Distributor",
       y = "Average Budget (millions of $)",
       title = "Top 10 Distributors with Highest Average Movie Budgets",
       subtitle = "Walt Disney Studios has the highest average production budget.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1,
                                   size = 7),
        legend.position = "none")
```

@fig-budget-distributor reveals the top 10 movie distribution companies that have the highest mean movie budgets, with Walt Disney Studios having the #1 spot. This again follows the correlations and findings that have been established in the EDA thus far, as explained previously. For example, @fig-distr-opening-wknd-success revealed that Walt Disney Studio has the highest average opening weekend revenue, @fig-dom-for-gross-distributor displayed Walt Disney Studios as the movie distributor with the most successful gross performance, and @fig-opening-wknd-by-budget ties all of these findings together by concluding that there exists a positive association between a Hollywood movie's budget and its gross earnings, thus explaining why Walt Disney Studios' status as the distributor with the highest budget lends it to also be the distributor with the highest opening weekend, domestic, and foreign revenues. Again, it is important to keep in mind there is a lot of missingness in the distributor variable, so there could be another company with a higher mean gross the Walt Disney Studios. However, the confirmation of previous findings and correlations still holds.

```{r}
#| label: fig-budget-oscars
#| fig-cap: The distribution of budget for movies that have won at lease one Oscar award and movies who have won 0 Oscars.

movie_data |> 
  filter(!is.na(oscar_winners)) |> 
  ggplot(aes(x = budget_million, y = oscar_winners)) +
  geom_boxplot() +
  labs(title = "Distribution of Movie Budget for Oscar-winning Movies and Movies with 
0 Oscar Wins",
       subtitle = "Oscar-winning movies have a lower average budget.",
       x = "Production Budget (millions of $)",
       y = "Oscar Winner") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot")

```

Similar to @fig-opening-wknd-oscar, @fig-budget-oscars shows that Hollywood movies that have won at least one Oscar award have an average production budget that is actually less than movies with no Oscar wins. This could suggest that having a high production budget does not relate to or increase the chances of a movie winning an Oscar and that having a high production budget may not be a factor taken into account when voting for Oscars.

```{r}
#| label: fig-budget-ratings
#| fig-cap: The associations of movie budget with 3 movie rating measures of the average of Rotten Tomatoes and Metacritic critic ratings, the average of Rotten Tomatoes and Metacritic audience ratings, and IMDb ratings.

budget_critic <- movie_data |> 
  ggplot(aes(x = budget_million, y = average_critics)) +
  geom_point(alpha = 0.25) +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(x = "Budget (millions of $)",
       y = "Average Critic Rating",
       title = "Critic Ratings by Movie Budget",
       subtitle = "There is a very weak association between 
the two variables.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 8))

budget_audience <- movie_data |> 
  ggplot(aes(x = budget_million, y = average_audience)) +
  geom_point(alpha = 0.25) +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(x = "Budget (millions of $)",
       y = "Average Audience Rating",
       title = "Audience Ratings by Movie Budget",
       subtitle = "There is a very weak association between 
the two variables.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 8))

budget_imdb <- movie_data |> 
  ggplot(aes(x = budget_million, y = im_db_rating)) +
  geom_point(alpha = 0.25) +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(x = "Budget (millions of $)",
       y = "IMDb Rating",
       title = "IMDb Ratings by Movie Budget",
       subtitle = "There is a very weak association between 
the two variables.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 8))

budget_critic + budget_audience + budget_imdb
```

@fig-budget-ratings seeks to explore how a movie's production budget is correlated with three rating measures: the average of Rotten Tomatoes and Metacritic critic scores, the average of Rotten Tomatoes and Metacritic audience scores, and IMDb ratings. For all three graphs, there seem to be positive correlations, but they are very weak as the data points are very spread out from each other. This could suggest that as movie budget increases, ratings increase, but the relationship is not very strong and movie budget is not a direct determinant of rating success.

## Variable 5: Oscar Wins

According to Britannica, the Oscars, also known as the Academy Awards, is an annual awards ceremony presented by the Academy of Motion Picture Arts and Sciences. Films are presented awards in 24 different categories ranging from costume design to original song.

```{r}
#| label: fig-oscar-wins-films
#| fig-cap: The top 10 films with the greatest number of Oscar awards.

 movie_data |> 
  select(film, oscar_count, oscar_detail) |> 
  arrange(desc(oscar_count)) |> 
  slice_head(n = 10) |> 
  DT::datatable()
```

As shown in @fig-oscar-wins-films, the film that has earned the greatest number of Oscar awards among the top movies released from 2007-2022 is "Everything Everywhere All at Once", with a whopping 7 Oscar awards. However, it is important to note that the Oscar variables contain a great number of missing values, and thus this may not be accurate; there could be another film with more Oscar wins. However, within the data that is present, "Everything Everywhere All at Once" has won significantly more Oscars than any other film.

```{r}
#| label: fig-genre-script-type-oscars
#| fig-cap: The top 5 movies with the most Oscar wins, by genre and script type.

genre_oscar_counts <- movie_data |> 
  filter(genre != "Action, Adventure, Mystery, Thriller, Fantasy, Comedy, Romance, Animation, Family, Musical") |> 
  group_by(genre) |> 
  summarize(oscar_count = sum(oscar_winners)) |> 
  arrange(desc(oscar_count)) |> 
  slice_head(n = 5)

genre_oscar_wins <- genre_oscar_counts |> 
  ggplot(aes(x = fct_reorder(genre, 
                             -oscar_count), 
             y = oscar_count, 
             fill = genre)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 5 Movies with the Most Oscar Wins by Genre",
       subtitle = "The 'biography, history' genre combination has the most Oscars.",
       x = "Genre",
       y = "Number of Oscar Wins") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 8),
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1), 
        legend.position = "none")


script_type_oscar_counts <- movie_data |> 
  filter(script_type != "") |> 
  group_by(script_type) |> 
  summarize(st_oscar_count = sum(oscar_winners, 
                                 na.rm = TRUE)) |> 
  arrange(desc(st_oscar_count)) |> 
  slice_head(n = 5)

script_type_oscar_wins <- script_type_oscar_counts |> 
  ggplot(aes(x = fct_reorder(script_type, 
                             -st_oscar_count), 
             y = st_oscar_count, 
             fill = script_type)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 5 Movies with the Most Oscar Wins by Script Type",
       subtitle = "The 'original screenplay' script type has the most Oscars.",
       x = "Script Type",
       y = "Number of Oscar Wins") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 8),
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none") +
  scale_y_continuous(breaks = seq(0,
                                  max(script_type_oscar_counts$st_oscar_count), 
                                  by = 5)) +
  scale_fill_viridis_d() 

genre_oscar_wins + script_type_oscar_wins
```

@fig-genre-script-type-oscars displays that the genre combination with the most Oscar wins is "biography, history", and the script type with the most Oscar wins is "original screenplay". This suggests that the movies categorized as "biography, history" or "original screenplay" are more successful among Oscar voters.

```{r}
#| label: fig-oscars-ww-gross
#| fig-cap: The disribution of worldwide gross revenue for movies that have won at least one Oscar award and movies who have won 0 Oscars.

movie_data |> 
  filter(!is.na(oscar_winners)) |> 
  ggplot(aes(x = worldwide_gross_million, 
             y = oscar_winners)) +
  geom_boxplot() +
  labs(title = "Distribution of Worldwide Gross for Oscar-winning Movies and Movies with 
0 Oscar Wins",
       subtitle = "Oscar-winning movies have a higher average worldwide gross.",
       x = "Worldwide Gross (millions of $)",
       y = "Oscar Winner") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot")
```

@fig-oscars-ww-gross shows that Hollywood movies that have won at least one Oscar award have an average worldwide gross earning that is greater than movies that have not won any Oscars. This could suggest a link between these two variables, in that movies that have won an Oscar also have a better worldwide box office revenue performance than movies that have not won any Oscars.

```{r}
#| label: fig-oscars-details-ratings
#| fig-cap: The top 10 Oscar categories with the highest average critic and audience ratings

movie_data |> 
  filter(!is.na(oscar_detail)) |> 
  group_by(oscar_detail) |> 
  summarize(mean_critic_rating = mean(average_critics, na.rm = TRUE),
            mean_aud_rating = mean(average_audience, na.rm = TRUE)) |> 
  arrange(desc(mean_critic_rating)) |> 
  slice_head(n = 10) |> 
  DT::datatable()
```

@fig-oscars-details-ratings is a table consisting of the Oscar award category combinations for movies with the highest average critic and audience ratings. It reveals that the Oscar award for "Best Supporting Actress (Patricia Arquette) has the highest mean critic rating of 99. This corresponds to a single movie in the data set, "Boyhood". The Oscar awards of "Best Picture, Best Director, Best Original Screenplay, and Best International Feature Film" have the highest mean audience rating of 91, and these awards were won by the movie "Parasite".

```{r}
#| label: fig-oscar-count-opening-wknd
#| fig-cap: A visualization of average opening weekend revenues for each possible number of Oscar awards that have been won by Hollywood movies.

movie_data |> 
  filter(!is.na(oscar_count)) |> 
  group_by(oscar_count) |> 
  summarize(avg_opening_wknd = mean(opening_weekend_million, 
                                    na.rm = TRUE)) |> 
  ggplot(aes(x = factor(oscar_count),
             y = avg_opening_wknd,
             fill = oscar_count)) +
  geom_bar(stat = "identity") +
  labs(x = "Number of Oscar Awards",
       y = "Average Opening Weekend Revenue (millions of $)",
       title = "Distribution of Average Opening Weekend Earnings by Oscar Award Count",
       subtitle = "Movies with 6 Oscars have the highest average opening weekend revenue.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        legend.position = "none")
```

@fig-oscar-count-opening-wknd displays average opening weekend revenues among the possible numbers of Oscar awards won by Hollywood movies over the years. The greatest average opening weekend was earned by movies with 6 Oscar awards. This corresponds to a single movie, "Mad Max: Fury Road", and the earnings are significantly higher than movies with 4 and 7 Oscar wins.

```{r}
#| label: fig-oscar-count-gross
#| fig-cap: A visualization of average domestic and foreign revenues for each possible number of Oscar awards that have been won by Hollywood movies.

oscar_count_dom_gross <- movie_data |> 
  filter(!is.na(oscar_count)) |> 
  group_by(oscar_count) |> 
  summarize(avg_dom_gross = mean(domestic_gross_million, 
                                    na.rm = TRUE)) |> 
  ggplot(aes(x = factor(oscar_count),
             y = avg_dom_gross,
             fill = oscar_count)) +
  geom_bar(stat = "identity") +
  labs(x = "Number of Oscar Awards",
       y = "Average Domestic Gross Revenue (millions of $)",
       title = "Distribution of Average Domestic Gross Earnings 
by Oscar Award Count",
       subtitle = "Movies with 1 Oscar have the highest average domestic gross revenue.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 7),
        legend.position = "none") +
  ylim(0, 250)


oscar_count_for_gross <- movie_data |> 
  filter(!is.na(oscar_count)) |> 
  group_by(oscar_count) |> 
  summarize(avg_for_gross = mean(foreign_gross_million, 
                                 na.rm = TRUE)) |> 
  ggplot(aes(x = factor(oscar_count),
             y = avg_for_gross,
             fill = oscar_count)) +
  geom_bar(stat = "identity") +
  labs(x = "Number of Oscar Awards",
       y = "Average Foreign Gross Revenue (millions of $)",
       title = "Distribution of Average Foreign Gross Earnings 
by Oscar Award Count",
       subtitle = "Movies with 1 Oscar have the highest average foreign gross revenue.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold",
                                  size = 9),
        plot.title.position = "plot",
        plot.subtitle = element_text(size = 7),
        legend.position = "none") +
  ylim (0, 250)

oscar_count_dom_gross + oscar_count_for_gross
```

@fig-oscar-count-gross displays the average domestic gross revenues and average foreign gross revenues among the possible numbers of Oscar awards won by Hollywood movies. Movies that have won 1 Oscar have both the highest average domestic and highest average foreign gross. Moreover, the two plots display similar patterns. This confirms the previous finding in @fig-gross-correlation of the correlation that exists between the domestic gross and foreign gross.

## Variable 6: Seasonal Release Date

These analyses seek to explore how the five main variables above vary/are impacted by the season a movie is released in, and what seasonal release date trends may exist in influencing a movie's success rate.

```{r}
#| label: fig-seasonal_ratings
#| fig-cap: A comparison of the mean ratings of movies based on the season they were released in, between the critic and audience rating groups.

seasonal_critics_plot <- movie_data |> 
  group_by(season)  |> 
  summarise(avg_critic_rating = round(mean(average_critics, 
                                           na.rm = TRUE)))  |> 
  arrange(desc(avg_critic_rating))  |> 
  ggplot(aes(x = season, 
             y = avg_critic_rating, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Critic Ratings by Season 
Movie was Released In",
       subtitle = "Movies released in the Fall have the greatest
average critic rating.",
       x = "Season",
       y = "Average Critic Rating",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none") +
  ylim(0, 70) 

seasonal_audience_plot <-  movie_data |>  
  group_by(season) |> 
  summarise(avg_audience_rating = mean(average_audience, 
                                       na.rm = TRUE)) |> 
  arrange(desc(avg_audience_rating)) |> 
  ggplot(aes(x = season, 
             y = avg_audience_rating, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Audience Ratings by Season 
Movie was Released In",
       subtitle = "Movies released in the Fall have the greatest
average audience rating.",
       x = "Season",
       y = "Average Audience Rating",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "none") +
  ylim(0, 70) 

seasonal_critics_plot + seasonal_audience_plot
```

@fig-seasonal_ratings shows a comparison between the average ratings for each season between the critic and audience rating groups. There appears to be a similar pattern for both rating groups' seasonal average critic numbers, with the highest ratings given for movies released in the Fall, and the lowest ratings given for movies released in the Winter. This reveals a similarity in the seasonal patterns of movie ratings for the two rating groups. However, the taller bars in the audience rating plot depict a disparity between the two groups' rating patterns in that the audience rating group gives out higher ratings than the critic rating group, as revealed in @fig-yearly-avg-ratings. @fig-seasonal_ratings visualizes a way in which the rating patterns for these two groups are similar, and confirms a previous finding of a way that their patterns differ. An overall conclusion can be made that movies released in the Fall have the highest ratings, while movies released in the Winter have the lowest ratings.

```{r}
#| label: fig-seasonal_opening_wknd
#| fig-cap: A comparison of the average opening weekend revenues in millions of dollars for movies based on what season they were relased in.

movie_data |> 
  group_by(season) |> 
  summarise(avg_opening_rev = mean(opening_weekend_million, 
                                   na.rm = TRUE)) |> 
  arrange(desc(avg_opening_rev)) |> 
  ggplot(aes(x = season, 
             y = avg_opening_rev, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Opening Weekend Revenue by Season Movie was Released In",
       subtitle = "Movies released in the Spring have the greatest average opening weekend revenue.",
       x = "Season",
       y = "Average Opening Weekend Revenue (millions of $)",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  theme(legend.position = "none")
```

In @fig-seasonal_opening_wknd, it is clear that movies released in the Spring have the highest average opening weekend revenue. This could suggest that movies that are released in the Spring are more successful in terms of generating more earnings during their first weekend in theaters than movies released in other seasons.

```{r}
#| label: fig-seasonal_gross
#| fig-cap: The average total revenue generated by films from all sources globally by the season the film was released in.

movie_data |> 
  ggplot(aes(x = season, 
             y = worldwide_gross_million, 
             fill = season)) +
  geom_boxplot() +
  labs(title = "Distribution of Worldwide Gross Earnings by Season Movie was Released In",
       subtitle = "Movies released in the summer have the greatest average worldwide gross.",
       x = "Season",
       y = "Worldwide Gross (millions of $)",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        legend.position = "none")
```

@fig-seasonal_gross shows that movies released during the Summer months have the highest average worldwide gross. This could be due to the fact that in many countries around the world, kids are on summer vacation during these months, and thus families are more likely to go to the movies and contribute to increased ticket sales overall.

```{r}
#| label: fig-seasonal_budget
#| fig-cap: A comparison of the average production budget of movies based on what season they were released in.

movie_data |> 
  group_by(season) |> 
  summarise(avg_budgets = mean(budget_million, na.rm = TRUE)) |> 
  arrange(desc(avg_budgets)) |> 
  ggplot(aes(x = season, 
             y = avg_budgets, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Movie Budgets by Season Movie was Released In",
       subtitle = "Movies released in the Spring have the highest average movie budgets.",
       x = "Season",
       y = "Average Movie Budget (millions of $)",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  theme(legend.position = "none")
```

@fig-seasonal_budget shows that movies released in the Spring have the highest average movie budgets. This directly aligns with previous findings in the EDA. In @fig-opening-wknd-by-budget, it was concluded that there exists a positive association between a Hollywood movie's budget and its opening weekend earnings. Therefore, since @fig-seasonal_opening_wknd revealed that the season of movies released with the highest average opening weekend revenue was Spring, then the season of movies released with the highest average movie budgets should also be Spring, and that is what we see in this plot. This supports the previous finding of the positive correlation that exists between a movie's budget and opening weekend revenue.

```{r}
#| label: fig-seasonal-opening-wknd-by-budget
#| fig-cap: The correlations of movie budget and opening weekend earnings for each movie release season

movie_data |> 
  ggplot(aes(x = budget_million,
             y = opening_weekend_million,
             color = season)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm",
              se = FALSE) +
  labs(title = "Relationship Between Movie Budget and Opening Weekend Revenue, 
by Season",
       subtitle = "Movies released in the Spring have the steepest correlation between the two variables.",
       x = "Budget (millions of $)",
       y = "Opening Weekend Revenue (millions of $)",
       color = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot")
```

In @fig-opening-wknd-by-budget, it was concluded that there exists is a clear positive association between a Hollywood movie's budget and its opening weekend revenue. @fig-seasonal-opening-wknd-by-budget again explores this relationship, this time by season. According to the graph, the season with the steepest correlation is "Spring". This suggests that for movies released in the Spring, as their production budget increases, their opening weekend revenue is earned at a higher rate than movies released in other seasons. This steep correlation for Spring makes sense, as it was concluded in @fig-seasonal_budget that movies released in the Spring have the highest average movie budgets, and @fig-seasonal_opening_wknd displayed that movies released in the Spring have the highest average opening weekend revenue.

```{r}
#| label: fig-seasonal-oscars
#| fig-cap: The distribution of Oscar wins based on what season the movie was released in.

movie_data |> 
  group_by(season) |> 
  filter(!is.na(oscar_winners)) |> 
  summarise(oscar_count = sum(oscar_winners)) |> 
  arrange(desc(oscar_count)) |> 
  ggplot(aes(x = season, 
             y = oscar_count, 
             fill = season)) +
  geom_bar(stat = "identity") +
  labs(title = "Number of Oscar Wins by Season Movie was Released In",
       subtitle = "Movies released in the Fall have the highest number of Oscar wins.",
       x = "Season",
       y = "Number of Oscar wins",
       fill = "Season") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  theme(legend.position = "none")
```

In @fig-seasonal-oscars, movies that were released in the Fall season won significantly more Oscars than movies released in other seasons. This is due to the fact that the Fall season is close to around the time when Oscar voting starts, and thus these films are more salient/relavent among the voters, but there is still enough time away from the start of voting for the films to gain enough popularity and traction before the awards are given out. From this, we can conclude that when defining a film's success solely based on the number of Oscar wins, releasing the film during the Fall season will greatly increase its chances of being successful.

```{r}
#| label: fig-seasonal-genre
#| fig-cap: The distribution of genre categories for each movie release season.

movie_data |> 
  filter(!is.na(primary_genre) & primary_genre != "") |> 
  ggplot(aes(x = season,
             fill = primary_genre)) +
  geom_bar(position = "dodge") +
  labs(x = "Season",
       y = "Proportion",
       fill = "Genre",
       title = "Genre Makeup of Each Movie Release Season",
       subtitle = "The 'action' genre is the most prevalent among all seasons except Fall.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        legend.position = "right")
```

@fig-seasonal-genre visualizes the genre distribution of movies for each season. According to the graph, the "action" genre made up a majority of the movies released in the Spring, Summer, and Winter, but for movies with a release date in the Fall, a majority of them were of the "crime" genre.

```{r}
#| label: fig-seasonal-script-type
#| fig-cap: The distribution of script type categories of the movies that were released in each season.

movie_data |> 
  filter(!is.na(script_type)) |> 
  ggplot(aes(x = season,
             fill = script_type)) +
  geom_bar(position = "dodge") +
  labs(x = "Season",
       y = "Proportion",
       fill = "Script Type",
       title = "Script Type Makeup of Movie Release Season",
       subtitle = "The 'original screenplay' script type is the most prevalent across all seasons.") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        legend.position = "right")
```

@fig-seasonal-script-type displays the script type distribution of the movies released in each season. As can be seen in the graph, the "original screenplay" category makes up the majority of movies across all seasons. This could suggest that this particular script type is the most common for films.

## Conclusion

After this extensive analysis of the "movie_data", numerous chief findings, key takeaways, and common patterns were brought to light. Most notably, it seems that certain variables such as opening weekend success, gross revenue, and budgets are highly impacted by economic turmoil such as the recession and the pandemic, the sequel & adaptation script type hybrid and genre categories of sci-fi, action, and adventure seem to be very popular, movies released in the Fall have a higher chance of winning an Oscar, and the overall most successful season of movie release is the Fall. Additionally, numerous positive correlations seem to be present within the data set: domestic gross by critic and audience movie ratings, budget recovery by opening weekend revenue, domestic and foreign gross by opening weekend revenue, Rotten Tomatoes audience scores by opening weekend revenue, foreign gross by domestic gross, percent of budget recovered and worldwide gross, opening weekend revenue and worldwide gross by movie budget, and finally, movie ratings by budget. All of these relationships reveal how interrelated the various factors that contribute to a movie's success rate are, and as discovered within numerous explorations in the EDA, knowing such correlations stand as predictive models and verifications for outcomes of certain explorations (such as audience rating groups giving consistently higher ratings than the critics, and the "sequel, adaptation" having both the highest mean budget and highest opening weekend revenue since budget and weekend revenue are highly correlated). Moreover, many findings were very insightful, such as the fact that the Rotten Tomatoes critic rating does not have much influence on opening weekend success like I had initially thought. On the other hand, many conclusions were to be expected, such as the fantasy genre having the highest mean budget, Oscar winning movies having a higher average critic rating than movies with 0 Oscars, the budget variable being positively and strongly correlated with "opening weekend revenue" and "gross" variables, and audience rating groups giving out higher ratings than critic rating groups overall. Overall, this EDA serves to provide a greater understanding of the certain conditions of variables that render a movie to be overall successful. "Success" can defined in numerous ways, from ratings, to gross revenue, to opening weekend revenue, to budget and budget recovery, to Oscar wins, and among these separate variables exist profound relationships and links to one another that further the understanding of what ultimately renders a Hollywood movie to be a "hit" or a "flop". In the future, I think it would be interesting to conduct a similar study on movies from the 1900s, and compare and contrast the factors that contribute to the success rates of movies from that era to the ones explored in this analysis of modern-day movies. For example, Rotten Tomatoes did not come about until the late 1990s, so that would not be a variable that is explored, but Oscars were around since the early 1900s, so it would be interesting to see how the findings for that variable compare between 20th and 21st century movies. This comparison of the explorations of movies from the 1900s to the explorations found in this EDA can bring to light the changes in films from then to now, contributing to an overall complex understanding of the movie industry.

## References

McCandless, D. (2023, October). *Hollywood Hits and Flops \[2007 - 2023\]*. Kaggle. https://www.kaggle.com/datasets/sujaykapadnis/hollywood-hits-and-flops-2007-2023

Tikkanen, A. (2023, December 4). *Academy Award*. Britannica. https://www.britannica.com/art/Academy-Award

## Appendix: technical info about the data joining/clean-up process
Overall, the raw form of Hollywood Hits and Flops required a very extensive amount of cleaning, both pre and post joining. As described in the Data Overview and Quality section, Hollywood Hits and Flops in its raw form is made up of 16 separate csv files, each pertaining to a year from 2007-2022. However, a simple joining of all 16 files was not possible due to differences between the data sets. For one, the data sets for 2007-2010 have 33 variables, 2011-2018 have 34 variables, and 2019-2022 have 35 variables. This difference in variable number is due to the fact that 2007-2010 data sets are missing the variables "financial source, if not The numbers" and "film list here", and the 2011-2018 data sets are missing the "film list here" variable. In order to combat this difference in variable numbers between the files, I decided to simply remove those extra columns in the 2011-2022 files, as there were NA values in every observation for those variable and they would not be relevant to my analysis. The next disparity lied in variable names, such as genre vs genres and differences in spacing between names. After skimming through these differences, I made all variable names uniform between all the data sets, and was then able to use rbind to join all 16 files into one data set called movie_data. However, an even deeper analysis of movie_data revealed that even more changes needed to be carried out before I could start my analysis. First, I cleaned up the variable names by changing all variables to snake case form. Next, there were numerous variables of types that were not conducive to perform an analysis on. For example, all of the variables with numbers as their observations such as critic variables and gross revenue were all of character type rather than integer, the release date variable was a character type rather than date, and variables with that dealt with percentages were character types with the % sign included rather than integer types. After identifying these variables, I carried out the respective character conversions. Third, numerous variables had unnecessary missing values. For example, many movies had missing values for their worldwide gross, even though their domestic and foreign gross values were present and worldwide gross is just a sum of domestic and foreign gross. Moreover, many movies genres were missing when their primary genres were available. Therefore, I filled in these NAs by setting NAs to worldwide gross to be the sum of domestic and foreign gross, and setting NAs in the genre variable to be whatever values was in the primary genre variable, if present. Next, the Oscar winners variable would display Oscar winner for movies that have won at least one Oscar award and blanks for movies with 0 Oscar awards. In order to be able to carry out analyses using this variable, I decided to convert the oscar winners variable from character to boolean type, and had it display TRUE to denote Oscar wins and FALSE to denote 0 Oscar wins. Another flaw that I observed was that there were incorrect millions conversions. For many variables such as opening weekend revenue and gross revenue, they also have a millions version where their numbers are represented in millions to make working with the large numbers less complicated. However, when skimming the data, I noticed that many of these conversions were incorrect (dividing by 100,000 instead of 1,000,000), which resulted in numbers being unreasonably high and inaccurate. Therefore, I replaced these millions columns in their entirety by performing my own math to receive the correct conversions. And last but not least, the last step to my post-join cleaning process was to add two new variables: season and oscar count. Using the release date variable and a case_when function, I created the season variable to denote the season of the year (fall, winter, spring, summer) that each movie was released in in order to perform seasonal analyses. Using the oscar detail variable and an ifelse statement, I created the oscar count variable to denote the total number of Oscar awards a movie has won. Finally, after all of these changes, deletions, and insertions were carried out, my movie_data data set was ready for analysis.

## Appendix: extra explorations
```{r}
#| label: fig-genre-script-type
#| fig-cap: A visualization of the genres present in each category of movie script type.

movie_data |> 
  filter(!is.na(primary_genre) & !is.na(script_type)) |> 
  ggplot(aes(x = script_type, 
             fill = primary_genre)) +
  geom_bar() +
  theme(legend.position = "bottom") +
  labs(title = "Genre Makeup of Each Script Type",
       subtitle = "Remakes are solely made up of western movies.",
       x = "Script Type",
       y = "Count",
       fill = "Genre") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot",
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1))
```
@fig-genre-script-type displays the distribution of the different genres that make up each script type. "Action" makes up a majority of adaptations, "drama" makes up a majority of filmed based on a true story, "thriller" makes up a majority of original screenplays, "western" makes up all of remakes, and "action" makes up a majority of sequels. "Action" genre movies seem to be very prevalent.

```{r}
#| label: fig-genre-trends
#| fig-cap: Trends in genre prevalence for Hollywood movies from 2007-2022.

movie_data |> 
  group_by(year, primary_genre) |> 
  filter(!is.na(primary_genre) & primary_genre != "") |> 
  summarize(count = n()) |> 
  ggplot(aes(x = year, y = count, color = primary_genre)) +
  geom_line() +
  labs(title = "Genre Trends Over Years",
       subtitle = "The 'action' genre has become the most prevalent.",
       x = "Year",
       y = "Number of Movies",
       color = "Genre") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  ylim(0, 30)
```
@fig-genre-trends visualizes how the prevalence of genres have changed over the years based on how many movies are released for each genre. Based on the graph, it seems that the genre category with the most movie releases is "action".

```{r}
#| label: fig-yearly-film-release
#| fig-cap: A visualization of the changes in the number of films released in each year from 2007-2022

yearly_film_count <- movie_data |> 
  group_by(year) |> 
  summarize(film_count = n())  |> 
  arrange(desc(film_count)) 

potential_outlier <- yearly_film_count |>
  filter(film_count == 66)

ggplot(yearly_film_count, 
                              aes(x = year, 
                                  y = film_count)) +
  geom_line() +
  geom_point() +
  geom_text_repel(data = potential_outlier, 
                  aes(label = "")) +
  geom_label(data = data.frame(label = "COVID-19 
 Pandemic"),
 aes(x = 2018.9, 
     y = 44, 
     label = label),
 fill = "gray", 
 alpha = 0.2, 
 hjust = 0, 
 vjust = 0) +
  geom_point(data = potential_outlier, 
             color = "red") +
  geom_point(
    data = potential_outlier,
    color = "red", 
    size = 3, 
    shape = "circle open") +
  labs(x = "Year", 
       y = "Number of Films Released", 
       title = "Number of Hollywood Movies Released in Each Year from 2007-2022",
       subtitle = "There was a dramtic drop in film release in 2020.") +
  theme_minimal() +
  ylim(0, 160) +
  theme(plot.title = element_text(face = "bold"),
        plot.title.position = "plot") +
  scale_x_continuous(breaks = seq(min(yearly_film_count$year), 
                                  max(yearly_film_count$year), 
                                  by = 2))
```
@fig-yearly-film-release displays the changes in the number of movies that were released for each year from 2007-2022. Most notably, there was a dramatic drop in the number of films released in 2019 to 2020, which can be explained by the 2020 COVID-19 pandemic and the fact that the nation was under quarantine.

```{r}
#| label: fig-highest-critic
#| fig-cap: Top 3 movies with the highest average critic ratings.

movie_data |> 
  select(film, 
         year, 
         script_type, 
         genre, 
         average_critics) |> 
  arrange(desc(average_critics)) |> 
  slice_head(n = 3) |> 
  DT::datatable()
```
The film with the highest average critic rating is "Boyhood", with a mean critic rating of 99. This is an original screenplay drama released in 2014.

```{r}
#| label: fig-highest-audience
#| fig-cap: Top 3 movies with the highest average audience ratings.

movie_data |> 
  select(film, 
         year, 
         script_type, 
         genre, 
         average_audience) |> 
  arrange(desc(average_audience)) |> 
  slice_head(n = 3) |> 
  DT::datatable()
```
The film with the highest average audience rating is "God's Not Dead: We the People", with a mean audience rating of 100. This is a drama of unknown script type released in 2021.

```{r}
#| label: fig-highest-opening-wnkd
#| fig-cap: Top 3 movies with the highest average opening weekend revenue.

movie_data |> 
  select(film, 
         year, 
         script_type, 
         genre, 
         opening_weekend_million) |> 
  arrange(desc(opening_weekend_million)) |> 
  slice_head(n = 3) |> 
  DT::datatable()
```
The film with the highest average opening weekend revenue is "Avengers: Endgame", with a mean opening weekend earning of $357 million. This is an action adaptation released in 2019.

```{r}
#| label: fig-highest-dom-gross
#| fig-cap: Top 3 movies with the highest average domestic gross revenue.

movie_data |> 
  select(film, 
         year, 
         script_type, 
         genre,
         domestic_gross_million) |> 
  arrange(desc(domestic_gross_million)) |> 
  slice_head(n = 3) |> 
  DT::datatable()
```
The film with the highest average domestic gross revenue is "Star Wars: Force Awakens", with a mean domestic gross earning of $937 million. This is a sci-fi, fantasy sequel released in 2015.

```{r}
#| label: fig-highest-for-gross
#| fig-cap: Top 3 movies with the highest average foreign gross revenue.

movie_data |> 
  select(film, 
         year, 
         script_type, 
         genre,
         foreign_gross_million) |> 
  arrange(desc(foreign_gross_million)) |> 
  slice_head(n = 3) |> 
  DT::datatable()
```
The film with the highest average foreign gross revenue is "Avatar", with a mean foreign gross earning of $2021 million. This is an action, adventure, and fantasy original screenplay released in 2009.

```{r}
#| label: fig-highest-ww-gross
#| fig-cap: Top 3 movies with the highest average worldwide gross revenue.

movie_data |> 
  select(film, 
         year, 
         script_type, 
         genre,
         worldwide_gross_million) |> 
  arrange(desc(worldwide_gross_million)) |> 
  slice_head(n = 3) |> 
  DT::datatable()
```
The film with the highest average worldwide gross revenue is "Star Wars: Force Awakens", with a mean worldwide gross earning of $2068 million. This is a sci-fi, fantasy sequel released in 2015.

```{r}
#| label: fig-highest-earned-abroad
#| fig-cap: Top 3 movies with the highest percentage of their revenue earned by foreign audiences.

movie_data |> 
  select(film, 
         year, 
         script_type, 
         genre,
         of_gross_earned_abroad) |> 
  arrange(desc(of_gross_earned_abroad)) |> 
  slice_head(n = 3) |> 
  DT::datatable()
```
The film with the highest percentage of its gross earned abroad is "Caf Society", with 264.84% of its gross earned abroad. This is an original screenplay drama released in 2016.

```{r}
#| label: fig-highest-budgets
#| fig-cap: Top 3 movies with the highest average production budgets.

movie_data |> 
  select(film, 
         year, 
         script_type, 
         genre,
         budget_million) |> 
  arrange(desc(budget_million)) |> 
  slice_head(n = 3) |> 
  DT::datatable()
```
The film with the highest average budget is "Avengers: Endgame", with a mean budget of $356 million. This is an action adaptation released in 2019

```{r}
#| label: fig-highest-budget-recovery
#| fig-cap: Top 3 movies with the highest percentage of their budget recovered.

movie_data |> 
  select(film, 
         year, 
         script_type, 
         genre,
         budget_recovered) |> 
  arrange(desc(budget_recovered)) |> 
  slice_head(n = 3) |> 
  DT::datatable()
```
The film with the highest percentage of their budget recovered is "Paranormal Activity", with 1289066.67% of its budget recovered. This is a horror, mystery original screenplay drama released in 2009.

```{r}
#| label: fig-highest-oscar
#| fig-cap: Top 3 movies with the most Oscar awards.

movie_data |> 
  select(film, 
         year, 
         script_type, 
         genre,
         oscar_count) |> 
  arrange(desc(oscar_count)) |> 
  slice_head(n = 3) |> 
  DT::datatable()
```
The film with the most Oscar wins is "Everything Everywhere All at Once", with 7 Oscar awards. This is an adventure, sci-fi, fantasy, comedy of unknown script type released in 2022.